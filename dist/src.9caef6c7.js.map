{"version":3,"sources":["../src/data/constants.ts","../src/helps/utils.ts","../src/helps/isSupported.ts","../src/helps/vitalsScore.ts","../src/helps/getNetworkInfo.ts","../src/helps/isLowEnd.ts","../src/helps/getNavigatorInfo.ts","../src/helps/onVisibilityChange.ts","../src/helps/index.ts","../src/typings/index.ts","../src/config/index.ts","../src/data/report.ts","../src/data/log.ts","../src/data/metrics.ts","../src/data/analyticsTacker.ts","../src/data/index.ts","../src/performance/observe.ts","../src/performance/navigationTiming.ts","../src/performance/storageEstimate.ts","../src/performance/resourceTiming.ts","../src/performance/firstInputDelay.ts","../src/performance/cumulativeLayoutShift.ts","../src/performance/paint.ts","../src/performance/performanceEntry.ts","../src/performance/index.ts","../node_modules/rrweb/lib/record/rrweb-record.js","../src/error/index.ts","../src/index.ts","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","push","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","document","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","length","concat","Function","deps","cached","cache","some","cb"],"mappings":"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AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;AClmEA;;AACA;;AACA;;AACA;;;;;;;;;;IAEqB;AAMjB,wBAAA;AAAA;;AACI,SAAK,YAAL,GAAoB,EAApB;AACH,IAED;;;;;WACQ,wBAAY;AAChB,UAAM,KAAK,GAAG,IAAd;;AACA,gCAAO;AACH,QAAA,IADG,gBACE,KADF,EACS,UADT,EACmB;AAClB;AACA,cAAI,UAAJ,EAAgB,KAAK,CAAC,YAAN,GAAqB,EAArB;;AAEhB,UAAA,KAAK,CAAC,YAAN,CAAmB,IAAnB,CAAwB,KAAxB;AACH,SANE;AAOH,QAAA,gBAAgB,EAAE,IAPf;AAQH,QAAA,gBAAgB,EAAE,IAAI,EAAJ,GAAS,IARxB,CAQ8B;;AAR9B,OAAP;AAUH,MAED;;;;WACQ,uBAAW;AAAA;;AACf,cAAE,OAAF,GAAY,UAAC,KAAD,EAAe,MAAf,EAAg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","file":"src.9caef6c7.js","sourceRoot":"../examples","sourcesContent":["interface Navigator {\n    appName: string\n    appVersion: string\n    estimate: any\n    storage: any\n    deviceMemory?: number\n    hardwareConcurrency?: number\n    connection?: string\n    effectiveType?: string\n    serviceWorker?: {\n        controller?: string\n    }\n    sendBeacon?: any\n}\nexport const W = window\nexport const D = document\nexport const C = W.console\nexport const WNav = (W.navigator as unknown) as Navigator\nexport const WPer = W.performance\n\n//内存\nexport const getMem = () => WNav.deviceMemory ?? 0\n//cpu核数\nexport const getCpu = () => WNav.hardwareConcurrency ?? 0\n","import { W } from '../data/constants';\n\n/**\n * pushTask - 将任务推入主线程空闲队列\n * @param cb - 执行的回调方法\n */\nexport const pushTask = function(cb: ()=> void) {\n    if ('requestIdleCallback' in W) {\n        (W as any).requestIdleCallback(cb, { timeOut: 3000 });\n    } else {\n        cb();\n    }\n}\n\n/**\n * formatByTwo - 格式化数值\n * @param num - 待格式化数值\n * @returns 保留2位小数位的数值\n */\nexport const formatByTwo = function(num: number): number {\n    return parseFloat(num.toFixed(2));\n}\n\n/**\n * convertToKB - 将字节转化位kb\n * @param byte - 字节长度\n * @returns kb大小\n */\nexport const convertToKB = function(byte: number): number|null  {\n    if (typeof byte !== 'number') return null;\n\n    return formatByTwo(byte / Math.pow(1024, 2));\n}","import { WPer, WNav, W, D } from '../data/constants';\n\n/**\n * True if the browser supports the Navigation Timing API,\n * User Timing API and the PerformanceObserver Interface.\n * In Safari, the User Timing API (performance.mark()) is not available,\n * so the DevTools timeline will not be annotated with marks.\n * Support: developer.mozilla.org/en-US/docs/Web/API/Performance/mark\n * Support: developer.mozilla.org/en-US/docs/Web/API/PerformanceObserver\n * Support: developer.mozilla.org/en-US/docs/Web/API/Performance/getEntriesByType\n */\nexport const isPerformanceSupported = (): boolean => {\n  return WPer && !!WPer.getEntriesByType && !!WPer.now && !!WPer.mark && !!W.PerformanceObserver;\n};\n\nexport const isEstimateSupported = (): boolean => {\n  return WNav && WNav.storage && typeof WNav.storage.estimate === 'function';\n}\n\nexport const isVisibleChangeSupported = (): boolean => {\n  return typeof D.hidden !== \"undefined\";\n}\n","import { YScore, YMonitorData } from '../typings';\n\n// https://web.dev/vitals/\nconst fcpScope = [1000, 2500];\nconst lcpScope = [2500, 4000];\nconst fidScope = [100, 300];\nconst clsScope = [0.1, 0.25];\nconst tbtScope = [300, 600];\n\nexport const webVitalsScore: Record<string, number[]> = {\n    fp: fcpScope,\n    fcp: fcpScope,\n    lcp: lcpScope,\n    lcpFinal: lcpScope,\n    fid: fidScope,\n    fidVital: fidScope,\n    cls: clsScope,\n    clsFinal: clsScope,\n    tbt: tbtScope,\n    tbt5s: tbtScope,\n    tbt10s: tbtScope,\n    tbtFinal: tbtScope,\n}\n\nexport const getVitalScope = (measureName: string, value: YMonitorData): YScore => {\n    if (!webVitalsScore[measureName]) return null;\n\n    if (value <= webVitalsScore[measureName][0]) return 'good';\n\n    return value <= webVitalsScore[measureName][1] ? 'needsImprovement' : 'poor';\n} \n","import { YNetworkInfo } from \"../typings\";\nimport { WNav } from '../data/constants';\n\nexport const getNetworkInfo = function():YNetworkInfo  {\n    if ('connection' in WNav) {\n        const connection = (WNav as any).connection;\n\n        if (typeof connection !== 'object') return {};\n\n        return {\n            rtt: connection.rtt,\n            downlink: connection.downlink,\n            saveData: connection.saveData,\n            effectiveType: connection.effectiveType,\n        }\n    } else {\n        // 多谱勒测速\n    }\n}","import { EffectiveConnectionType } from '../typings';\nimport { WNav, getCpu, getMem } from \"../data/constants\";\n\n// 是否低等级设备\nexport const isLowEndDevice = function(): boolean {\n    // If number of logical processors available to run threads <= 4\n    if (getCpu() && getCpu() <= 4) {\n        return true;\n    }\n    // If the approximate amount of RAM client device has <= 4\n    if (getMem() && getMem() <= 4) {\n        return true;\n    }\n\n    return false;\n}\n\n// 是否低体验设备\nexport const isLowEndExperience = function(): boolean {\n    if (!WNav.connection || typeof WNav.connection !== 'object') return true;\n\n    const effectiveType: EffectiveConnectionType = (WNav.connection as any).effectiveType;\n    \n    if (['lte', 'slow-2g', '2g', '3g'].includes(effectiveType) || isLowEndDevice) return true;\n\n    return false;\n}\n","import { YNavigatorInfo } from \"../typings\";\nimport { WNav, getMem, getCpu } from '../data/constants';\nimport { isLowEndDevice, isLowEndExperience } from './isLowEnd';\n\n/**\n * 如下信息来源于 window.navigator:\n * 1. Device Memory\n * 2. Hardware Concurency\n * 3. Status of the service worker:\n *     - controlled: a service worker is controlling the page\n *     - supported: the browser supports service worker\n *     - unsupported: the user's browser does not support service worker\n */\nexport const getNavgatorInfo = function(): YNavigatorInfo {\n    if (!WNav) return {};\n\n    return {\n        appName: WNav.appName,\n        appVersion: WNav.appVersion,\n        deviceMemory: getMem() || 0,\n        hardwareConcurrency: getCpu() || 0,\n        isLowEndDevice: isLowEndDevice(),\n        isLowEndExperience: isLowEndExperience(),\n        serviceWorkerStatus: \n            'serviceWorker' in WNav ? \n                WNav.serviceWorker!.controller ? \n                'controlled'\n                : 'supported'\n            : 'unSupported',\n    }\n}","import { D } from '../data/constants';\n\nexport const visibility = {\n  isHidden: false,\n};\n\n/**\n * From visibilitychange listener it saves only when\n * the page gets hidden, because it's important to not\n * use the wrong \"hidden\" value when send timing or logging.\n */\nexport const didVisibilityChange = function (cb: Function) {\n  if (D.hidden) {\n    cb();\n    visibility.isHidden = D.hidden;\n  }\n};","export * from './utils';\nexport * from './isSupported';\nexport * from './vitalsScore';\nexport * from './getNetworkInfo';\nexport * from './getNavigatorInfo';\nexport * from './onVisibilityChange';","/**\n * 监控入口参数\n * @param isPerformanceTrace - 是否开启性能监控\n * @param isErrorCapture -  是否开启异常监控\n * @param isResoureTiming - 是否开启资源监控\n * @param isElementTiming - 是否开启元素监控\n * @param maxMeasureTime -  最大监控时间\n * @param upUrl - 上报url\n * @param analyticsTracker - 监控方法\n */\nexport interface YMonitorOptions {\n    isPerformanceTrace?: boolean\n    isErrorCapture?: boolean\n    isResoureTiming?: boolean\n    isElementTiming?: boolean\n    maxMeasureTime?: number\n    upUrl: string\n    analyticsTracker?: (options: YAnalyticsTrackerOptions) => void\n}\n\n// 监控配置参数\nexport interface YMonitorConfig {\n    isPerformanceTrace?: boolean\n    isResoureTiming?: boolean\n    isElementTiming?: boolean\n    isErrorCapture?: boolean\n    maxTime?: number\n    report: YMonitorReport\n    analyticsTracker?: (options: YAnalyticsTrackerOptions) => void\n}\n\n/**\n * 分析工具参数\n * @param metricName - 分析指标\n * @param data - 分析数据\n * @param eventProperties - 分析事件属性\n * @param navigatorInformation -\n * @param score - 分析评分\n */\nexport interface YAnalyticsTrackerOptions {\n    metricName: string\n    data: YMonitorData\n    customProperties: object\n    navigatorInfo: YNavigatorInfo\n    netWorkInfo?: YNetworkInfo\n    score: YScore\n}\n\n// 监控指标的相关信息\nexport type YMonitorData = YNavigationTiming | YConsumption\n\n/**\n * 页面请求渲染时间\n */\nexport interface YNavigationTiming {\n    fetchTime?: number\n    workerTime?: number\n    totalTime?: number\n    downloadTime?: number\n    timeToFirstByte?: number\n    headerSize?: number\n    dnsLookupTime?: number\n    tcpTime?: number\n    whiteTime?: number\n    domTime?: number\n    loadTime?: number\n    parseDomTime?: number\n}\n\n// 监控资源类别\nexport interface YConsumption {\n    css: number\n    img: number\n    other: number\n    script: number\n    total: number\n    beacon: number\n    fetch: number\n    xmlhttprequest: number\n}\n\n// 网络类型\nexport type EffectiveConnectionType = '2g' | '3g' | '4g' | '5g' | 'slow-2g' | 'lte'\n\n// 网络信息\nexport interface YNetworkInfo {\n    downlink?: number\n    effectiveType?: EffectiveConnectionType\n    onchange?: () => void\n    rtt?: number\n    saveData?: boolean\n}\n\n/**\n * 浏览器信息\n * @param appName - 应用名称\n * @param appVersion - 应用版本\n * @param deviceMemory - 设备内存\n * @param hardwareConcurrency - cpu核数\n * @param serviceWorkerStatus - serviceWorker状态\n * @param isLowEndDevice - 是否低性能设备\n * @param isLowEndExperience - 是否体验欠佳设备\n */\nexport interface YNavigatorInfo {\n    appName?: string\n    appVersion?: string\n    deviceMemory?: number\n    hardwareConcurrency?: number\n    isLowEndDevice?: boolean\n    isLowEndExperience?: boolean\n    serviceWorkerStatus?: 'controlled' | 'supported' | 'unSupported'\n}\n\n// 评分等级\nexport type YScore = 'good' | 'needsImprovement' | 'poor'\n\n// 监控上报方法\nexport interface YMonitorReport {\n    sendToAnalytics(level: AskPriority, data: string, uri?: string): void\n}\n\n// 优先级\nexport enum AskPriority {\n    URGENT = 1,\n    IDLE = 2,\n}\n\n// 上报参数\nexport type ReportOtions = {\n    upUrl: string\n}\n\n// 错误类型枚举\nexport enum ErrorType {\n    'SCRIPT' = 1,\n    'PROMISE' = 2,\n    'NETWORK' = 3,\n}\n\n// 性能监控对象\nexport interface YPerObservers {\n    [measure: string]: any\n}\n\n// 性能指标\nexport type YPerformanceObserverType =\n    | 'paint'\n    | 'first-input'\n    | 'largest-contentful-paint'\n    | 'layout-shift'\n    | 'longtask'\n    | 'element'\n    | 'resource'\n    | 'measure'\n    | 'navigation'\n\n// 测量指标数据\nexport interface YMetricMap {\n    [measureName: string]: number\n}\n\n// 测试资源入口\nexport interface YPerformanceEntry {\n    processingStart: number\n    decodedBodySize?: number\n    duration: number\n    entryType: YPerformanceObserverType\n    initiatorType?: keyof YConsumption\n    loadTime: number\n    name: string\n    renderTime: number\n    startTime: number\n    hadRecentInput?: boolean\n    value?: number\n    identifier?: string\n}\n","import { YMonitorConfig } from '../typings'\n\nexport const config: YMonitorConfig = {\n    isPerformanceTrace: true,\n    isErrorCapture: true,\n    isResoureTiming: true,\n    isElementTiming: true,\n    maxTime: 15000,\n    report: null,\n    analyticsTracker: null,\n}","import { AskPriority, YMonitorReport, ReportOtions } from '../typings'\nimport { config } from '../config'\nimport { W, WNav } from './constants'\nimport { visibility, pushTask, getNavgatorInfo, getNetworkInfo, getVitalScope } from '../helps'\n\nexport class Report implements YMonitorReport {\n    private upUrl: string\n\n    constructor(options: ReportOtions) {\n        if (!options.upUrl) {\n            throw Error('监控sdk需提供上报uri!')\n        }\n        this.upUrl = options.upUrl\n    }\n\n    /**\n     * 统一上报方法\n     * @param level - 上报等级\n     * @param data - 上报数据\n     * @param uri - 上报uri\n     */\n    sendToAnalytics(level: AskPriority, data: string, uri?: string): void {\n        const upUrl = uri || this.upUrl\n\n        // 高优先级处理\n        if (level === AskPriority.URGENT) {\n            if (!!W.fetch) {\n                fetch(upUrl, { method: 'post', body: data, keepalive: true })\n            } else {\n                let xhr: XMLHttpRequest = new XMLHttpRequest()\n                xhr.open('post', upUrl, true)\n                xhr.setRequestHeader('Content-Type', 'application/json')\n                xhr.send(data)\n                xhr.onload = function () {\n                    if (this.status === 200 || this.status === 304) {\n                        console.log('xhr response', this.response)\n                    }\n                    //及时清理以防多次创建\n                    xhr = null\n                }\n            }\n        } else if (level === AskPriority.IDLE) {\n            if (!!WNav.sendBeacon) {\n                WNav.sendBeacon(upUrl, data)\n            } else {\n                let img: HTMLImageElement = new Image()\n                img.src = `${upUrl}?body=${data}`\n                img.onload = function () {\n                    //统计完成收回创建的元素防止内存泄露\n                    img = null\n                }\n            }\n        }\n    }\n\n    /**\n     * 性能上报方法\n     * @param metricName - 性能指标\n     * @param data - 性能数据\n     * @param customProperties - 自定义数据\n     */\n    static reportPerformance(metricName: string, data: any, customProperties?: object) {\n        pushTask(() => {\n            if ((visibility.isHidden && metricName.indexOf('Final') < 0) || !config.analyticsTracker) return\n            config.analyticsTracker({\n                data,\n                metricName,\n                customProperties,\n                score: getVitalScope(metricName, data),\n                netWorkInfo: getNetworkInfo(),\n                navigatorInfo: getNavgatorInfo(),\n            })\n        })\n    }\n}\n","import { Report } from './report';\nimport { config } from '../config';\nimport { formatByTwo } from '../helps';\n\nexport const logInfo = (measureName: string, data: any, customProperties?: object) => {\n    Object.keys(data).forEach((key) => {\n        if (typeof data[key] === 'number') {\n            data[key] = formatByTwo(data[key]);\n        }\n    });\n    // Sends the metric to an external tracking service\n    Report.reportPerformance(measureName, data, customProperties);\n}\n\nexport const logMetric = (measureName: string, data: any, customProperties?: object) => {\n    const duration2Decimal = formatByTwo(data);\n    if (duration2Decimal >= 0 && duration2Decimal <= config.maxTime) {\n        Report.reportPerformance(measureName, duration2Decimal, customProperties);\n    }\n}","import { YMetricMap, YConsumption } from '../typings'\n\n// 测量指标数据\nexport const metrics: YMetricMap = {\n    fid: 0, // 首次输入延迟 -- first input delay\n    fcp: 0, // 首次有内容渲染耗时 -- first contentful paint\n    lcp: 0, // 最大内容渲染耗时 -- largest contentful paint \n    cls: 0, // 累计位移偏移 -- cumulative layout shift\n    tbt: 0, // 阻塞总时间 -- total blocking time\n}\n// 测试资源耗时\nexport const rt: { value: YConsumption} = {\n    value: {\n        css: 0,\n        img: 0,\n        other: 0,\n        script: 0,\n        total: 0,\n        beacon: 0,\n        fetch: 0,\n        xmlhttprequest: 0,\n    }\n}","import { YAnalyticsTrackerOptions } from \"../typings\";\n\n// 自定义分析器\nexport const analyticsTracker = function(options: YAnalyticsTrackerOptions) {\n    console.log('analyticsTracker', options);\n}","export * from './log'\nexport * from './report'\nexport * from './metrics'\nexport * from './constants'\nexport * from './analyticsTacker'\n","import { YPerObservers, YPerformanceObserverType } from '../typings';\nimport { C } from '../data/constants';\n\nclass PerformanceObserve {\n    private perfObserveMap: YPerObservers;\n\n    constructor() {\n        this.perfObserveMap = new Map();\n    }\n\n    // 观察单个性能指标\n    poConnect(observeType: YPerformanceObserverType, cb: (args: any[]) => void) {\n        try {\n            const perfObserver = new PerformanceObserver(entryList => {\n                cb(entryList.getEntries());\n            });\n\n            // 订阅时间或者开始计时 buffered不立即执行在内存中留下PerformanceObserver实例\n            perfObserver.observe({ type: observeType, buffered: true });\n            this.perfObserveMap.set(observeType, perfObserver);\n        } catch(msg) {\n            C.warn('poConnect warn', msg);\n        }\n    }\n\n    // 断开观察单个性能指标\n    poDisconnect(observeType: any) {\n        if (this.perfObserveMap.get(observeType)) {\n            this.perfObserveMap.get(observeType).disconnect();\n            this.perfObserveMap.delete(observeType);\n        }\n    }\n}\n\nexport const performanceObserver = new PerformanceObserve();","import { YNavigationTiming } from '../typings';\nimport { isPerformanceSupported } from '../helps/isSupported';\n\n/**\n * Navigation Timing API provides performance metrics for HTML documents.\n * w3c.github.io/navigation-timing/\n * developers.google.com/web/fundamentals/performance/navigation-and-resource-timing\n */\nexport const getNavigationTiming = ():YNavigationTiming => {\n    // 不支持性能检测api直接返回\n    if (!isPerformanceSupported) return {};\n\n    // 这里直接的物理赋值performance.timing 已被弃用\n    const t = performance.getEntriesByType('navigation')[0] as any;\n    if (!t) return {};\n\n    const responseStart = t.responseStart;\n    const responseEnd = t.responseEnd;\n\n    return {\n        // fetchStart marks when the browser starts to fetch a resource\n        // responseEnd marks when the last byte of the response arrives\n        fetchTime: responseEnd - t.fetchStart || 0,\n        // serviecworker time plus response time\n        workerTime: t.workerStart ? responseEnd - t.workerStart : 0,\n        // requset plus response time (network noly)\n        totalTime: responseEnd - t.requestStart || 0,\n        // response time only \n        downloadTime: responseEnd - responseStart || 0,\n        // TTFB\n        timeToFirstByte: responseStart - t.fetchStart || 0,\n        // http header size\n        headerSize: t.transferSize - t.encodedBodySize || 0,\n        // DNS解析时间\n        dnsLookupTime: t.dnsLookupTimeEnd - t.dnsLookupTimeStart || 0,\n        // tcp建立链接时间\n        tcpTime: t.connectEnd - t.connectStart || 0,\n        // 白屏时间\n        whiteTime: responseStart - t.navigationStart || 0,\n        // 页面渲染dom时间\n        domTime: t.domContentLoadedEventEnd - t.navigationStart || 0,\n        // 页面加载时间\n        loadTime: t.loadEventEnd - t.navigationStart || 0,\n        // DOM解析时间\n        parseDomTime: t.domComplete - t.domInteractive || 0,\n    }\n}","import { logInfo } from '../data';\nimport { convertToKB } from '../helps';\n\n/**\n * The estimate() method of the StorageManager interface asks the Storage Manager\n * for how much storage the app takes up (usage),\n * and how much space is available (quota).\n */\nexport const getStorageEstimate = (storageInfo: StorageEstimate) => {\n    const estimateUsageDetails = (storageInfo as any).useageDetails || {};\n\n    logInfo('storageEstimate', {\n        quota: convertToKB(storageInfo.quota),\n        usage: convertToKB(storageInfo.usage),\n        caches: convertToKB(estimateUsageDetails.caches),\n        indexedDB: convertToKB(estimateUsageDetails.indexedDB),\n        ServiceWorker: convertToKB(estimateUsageDetails.ServiceWorker),\n    });\n}","import { YPerformanceEntry } from '../typings'\nimport { logInfo, rt } from '../data'\nimport { config } from '../config'\n\n// 初始化资源时间\nexport const initResourceTiming = (performanceEntries: YPerformanceEntry[]): void => {\n    performanceEntries.forEach(entry => {\n        if (config.isResoureTiming) {\n            logInfo('resourceTiming', entry)\n        }\n        if (entry.decodedBodySize && entry.initiatorType) {\n            const bodySize = entry.decodedBodySize / 1000\n            rt.value[entry.initiatorType] += bodySize;\n            rt.value.total += bodySize;\n        }\n    });\n}","import { YPerformanceEntry } from '../typings'\nimport { logInfo, logMetric, metrics, rt } from '../data'\nimport { performanceObserver } from './observe'\n\n// 初始化首次输入延迟\nexport const initFirstInputDelay = (performanceEntries: YPerformanceEntry[]):void => {\n    const lastEntry = performanceEntries.pop()\n\n    if (lastEntry) {\n        // 传统fid测量\n        logMetric('fid', lastEntry.duration, {\n            performanceEntries: lastEntry,\n        })\n        logMetric('fidVitals', lastEntry.processingStart - lastEntry.startTime, {\n            performanceEntries: lastEntry,\n        })\n    }\n    performanceObserver.poDisconnect('first-input')\n\n    logMetric('tbt', metrics.tbt)\n    logMetric('cls', metrics.cls)\n    // TBT with 5 second delay after FID\n    setTimeout(() => {\n        logMetric('tbt5S', metrics.tbt)\n    }, 5000)\n    // TBT with 10 second delay after FID\n    setTimeout(() => {\n        logMetric('tbt10S', metrics.tbt)\n        //FID被激活以后10S的整体数据消耗\n        logInfo('consumptionInfo', rt.value)\n    }, 10000)\n}","import { YPerformanceEntry } from '../typings'\nimport { logMetric, metrics } from '../data'\n\n// 初始化累计位移偏移\nexport const initCumulativeLayoutShift = (performanceEntries: YPerformanceEntry[]): void => {\n    const lastEntry = performanceEntries.pop();\n\n    if (lastEntry && !lastEntry.hadRecentInput && lastEntry.value) {\n        metrics.cls += lastEntry.value\n        logMetric('cls', metrics.cls)\n    }\n}","import { YPerformanceEntry } from '../typings'\nimport { logMetric, metrics } from '../data'\nimport { performanceObserver } from './observe'\n\n// 初始化首次绘制\nexport const initPaint = (performanceEntries: YPerformanceEntry[]): void => {\n    performanceEntries.some((entry) => {\n        if (entry.name === 'first-paint') {\n            logMetric('fp', entry.startTime)\n            return true\n        } else if (entry.name === 'first-contentful-paint') {\n            metrics.fcp = entry.startTime\n            logMetric('fcp', metrics.fcp)\n            return true\n        }\n    })\n    // 解除监听\n    performanceObserver.poDisconnect('paint')\n}\n\n// 初始化最大内容绘制\nexport const initLargestContentfulPaint = (performanceEntries: YPerformanceEntry[]): void => {\n    const lastEntry = performanceEntries.pop()\n\n    if (lastEntry) {\n        metrics.lcp = lastEntry.renderTime || lastEntry.loadTime\n        logMetric('lcp', metrics.lcp)\n    }\n}\n\n// 初始化元素渲染时间\nexport const initElementTiming = (performanceEntries: YPerformanceEntry[]): void => {\n    performanceEntries.some(entry => {\n        if (entry.identifier) {\n            logMetric(entry.identifier, entry.startTime)\n        }\n    })\n}\n","import { config } from '../config'\nimport { isEstimateSupported, isVisibleChangeSupported, didVisibilityChange } from '../helps'\nimport { WNav, D, logInfo } from '../data'\nimport { performanceObserver } from './observe'\nimport { getNavigationTiming } from './navigationTiming'\nimport { getStorageEstimate } from './storageEstimate'\nimport { initResourceTiming } from './resourceTiming'\nimport { initFirstInputDelay } from './firstInputDelay'\nimport { initCumulativeLayoutShift } from './cumulativeLayoutShift'\nimport { initPaint, initLargestContentfulPaint, initElementTiming } from './paint'\n\n// 根据参数监听相关指标\nconst initPerformanceObserver = (): void => {\n    console.log('⏰ 性能收集开始', Math.random())\n    performanceObserver.poConnect('paint', initPaint)\n    performanceObserver.poConnect('first-input', initFirstInputDelay)\n    performanceObserver.poConnect('layout-shift', initCumulativeLayoutShift)\n    performanceObserver.poConnect('largest-contentful-paint', initLargestContentfulPaint)\n\n    if (config.isResoureTiming) {\n        performanceObserver.poConnect('resource', initResourceTiming)\n    }\n    if (config.isElementTiming) {\n        performanceObserver.poConnect('element', initElementTiming)\n    }\n}\n\n// 根据相关检测指标解除监听\nconst disconnectPerformanceObserve = (args: string[] | string): void => {\n    const list = Array.isArray(args) ? args : [args]\n\n    list.forEach((metric) => {\n        performanceObserver.poDisconnect(metric)\n    })\n}\n\n// 初始化性能监控\nexport const initPerformanceTraceEntry = (): void => {\n    //监控相关指标\n    initPerformanceObserver()\n\n    //页面性能\n    logInfo('navigationTiming', getNavigationTiming())\n\n    //管理离线缓存数据\n    if (isEstimateSupported()) {\n        WNav.storage.estimate().then(getStorageEstimate)\n    }\n\n    //页面切换时解除观察\n    if (isVisibleChangeSupported()) {\n        D.addEventListener('visibilitychange', didVisibilityChange.bind(this, disconnectPerformanceObserveHidden))\n    }\n}\n\n// 页面隐藏时解除监听性能指标\nexport const disconnectPerformanceObserveHidden = (): void => {\n    disconnectPerformanceObserve([\n        'paint',\n        'element',\n        'largest-contentful-paint',\n        'resource',\n        'layout-shift',\n        'first-input',\n    ])\n}\n","export * from './observe';\nexport * from './performanceEntry';","'use strict';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\n\nvar NodeType;\n(function (NodeType) {\n    NodeType[NodeType[\"Document\"] = 0] = \"Document\";\n    NodeType[NodeType[\"DocumentType\"] = 1] = \"DocumentType\";\n    NodeType[NodeType[\"Element\"] = 2] = \"Element\";\n    NodeType[NodeType[\"Text\"] = 3] = \"Text\";\n    NodeType[NodeType[\"CDATA\"] = 4] = \"CDATA\";\n    NodeType[NodeType[\"Comment\"] = 5] = \"Comment\";\n})(NodeType || (NodeType = {}));\n\nvar _id = 1;\nvar tagNameRegex = RegExp('[^a-z1-6-_]');\nvar IGNORED_NODE = -2;\nfunction genId() {\n    return _id++;\n}\nfunction getValidTagName(element) {\n    if (element instanceof HTMLFormElement) {\n        return 'form';\n    }\n    var processedTagName = element.tagName.toLowerCase().trim();\n    if (tagNameRegex.test(processedTagName)) {\n        return 'div';\n    }\n    return processedTagName;\n}\nfunction getCssRulesString(s) {\n    try {\n        var rules = s.rules || s.cssRules;\n        return rules ? Array.from(rules).map(getCssRuleString).join('') : null;\n    }\n    catch (error) {\n        return null;\n    }\n}\nfunction getCssRuleString(rule) {\n    return isCSSImportRule(rule)\n        ? getCssRulesString(rule.styleSheet) || ''\n        : rule.cssText;\n}\nfunction isCSSImportRule(rule) {\n    return 'styleSheet' in rule;\n}\nfunction extractOrigin(url) {\n    var origin;\n    if (url.indexOf('//') > -1) {\n        origin = url.split('/').slice(0, 3).join('/');\n    }\n    else {\n        origin = url.split('/')[0];\n    }\n    origin = origin.split('?')[0];\n    return origin;\n}\nvar URL_IN_CSS_REF = /url\\((?:(')([^']*)'|(\")([^\"]*)\"|([^)]*))\\)/gm;\nvar RELATIVE_PATH = /^(?!www\\.|(?:http|ftp)s?:\\/\\/|[A-Za-z]:\\\\|\\/\\/|#).*/;\nvar DATA_URI = /^(data:)([^,]*),(.*)/i;\nfunction absoluteToStylesheet(cssText, href) {\n    return (cssText || '').replace(URL_IN_CSS_REF, function (origin, quote1, path1, quote2, path2, path3) {\n        var filePath = path1 || path2 || path3;\n        var maybeQuote = quote1 || quote2 || '';\n        if (!filePath) {\n            return origin;\n        }\n        if (!RELATIVE_PATH.test(filePath)) {\n            return \"url(\" + maybeQuote + filePath + maybeQuote + \")\";\n        }\n        if (DATA_URI.test(filePath)) {\n            return \"url(\" + maybeQuote + filePath + maybeQuote + \")\";\n        }\n        if (filePath[0] === '/') {\n            return \"url(\" + maybeQuote + (extractOrigin(href) + filePath) + maybeQuote + \")\";\n        }\n        var stack = href.split('/');\n        var parts = filePath.split('/');\n        stack.pop();\n        for (var _i = 0, parts_1 = parts; _i < parts_1.length; _i++) {\n            var part = parts_1[_i];\n            if (part === '.') {\n                continue;\n            }\n            else if (part === '..') {\n                stack.pop();\n            }\n            else {\n                stack.push(part);\n            }\n        }\n        return \"url(\" + maybeQuote + stack.join('/') + maybeQuote + \")\";\n    });\n}\nfunction getAbsoluteSrcsetString(doc, attributeValue) {\n    if (attributeValue.trim() === '') {\n        return attributeValue;\n    }\n    var srcsetValues = attributeValue.split(',');\n    var resultingSrcsetString = srcsetValues\n        .map(function (srcItem) {\n        var trimmedSrcItem = srcItem.trimLeft().trimRight();\n        var urlAndSize = trimmedSrcItem.split(' ');\n        if (urlAndSize.length === 2) {\n            var absUrl = absoluteToDoc(doc, urlAndSize[0]);\n            return absUrl + \" \" + urlAndSize[1];\n        }\n        else if (urlAndSize.length === 1) {\n            var absUrl = absoluteToDoc(doc, urlAndSize[0]);\n            return \"\" + absUrl;\n        }\n        return '';\n    })\n        .join(', ');\n    return resultingSrcsetString;\n}\nfunction absoluteToDoc(doc, attributeValue) {\n    if (!attributeValue || attributeValue.trim() === '') {\n        return attributeValue;\n    }\n    var a = doc.createElement('a');\n    a.href = attributeValue;\n    return a.href;\n}\nfunction isSVGElement(el) {\n    return el.tagName === 'svg' || el instanceof SVGElement;\n}\nfunction transformAttribute(doc, name, value) {\n    if (name === 'src' || ((name === 'href' || name === 'xlink:href') && value)) {\n        return absoluteToDoc(doc, value);\n    }\n    else if (name === 'srcset' && value) {\n        return getAbsoluteSrcsetString(doc, value);\n    }\n    else if (name === 'style' && value) {\n        return absoluteToStylesheet(value, location.href);\n    }\n    else {\n        return value;\n    }\n}\nfunction _isBlockedElement(element, blockClass, blockSelector) {\n    if (typeof blockClass === 'string') {\n        if (element.classList.contains(blockClass)) {\n            return true;\n        }\n    }\n    else {\n        element.classList.forEach(function (className) {\n            if (blockClass.test(className)) {\n                return true;\n            }\n        });\n    }\n    if (blockSelector) {\n        return element.matches(blockSelector);\n    }\n    return false;\n}\nfunction serializeNode(n, options) {\n    var doc = options.doc, blockClass = options.blockClass, blockSelector = options.blockSelector, inlineStylesheet = options.inlineStylesheet, _a = options.maskInputOptions, maskInputOptions = _a === void 0 ? {} : _a, recordCanvas = options.recordCanvas;\n    switch (n.nodeType) {\n        case n.DOCUMENT_NODE:\n            return {\n                type: NodeType.Document,\n                childNodes: [],\n            };\n        case n.DOCUMENT_TYPE_NODE:\n            return {\n                type: NodeType.DocumentType,\n                name: n.name,\n                publicId: n.publicId,\n                systemId: n.systemId,\n            };\n        case n.ELEMENT_NODE:\n            var needBlock = _isBlockedElement(n, blockClass, blockSelector);\n            var tagName = getValidTagName(n);\n            var attributes_1 = {};\n            for (var _i = 0, _b = Array.from(n.attributes); _i < _b.length; _i++) {\n                var _c = _b[_i], name = _c.name, value = _c.value;\n                attributes_1[name] = transformAttribute(doc, name, value);\n            }\n            if (tagName === 'link' && inlineStylesheet) {\n                var stylesheet = Array.from(doc.styleSheets).find(function (s) {\n                    return s.href === n.href;\n                });\n                var cssText = getCssRulesString(stylesheet);\n                if (cssText) {\n                    delete attributes_1.rel;\n                    delete attributes_1.href;\n                    attributes_1._cssText = absoluteToStylesheet(cssText, stylesheet.href);\n                }\n            }\n            if (tagName === 'style' &&\n                n.sheet &&\n                !(n.innerText ||\n                    n.textContent ||\n                    '').trim().length) {\n                var cssText = getCssRulesString(n.sheet);\n                if (cssText) {\n                    attributes_1._cssText = absoluteToStylesheet(cssText, location.href);\n                }\n            }\n            if (tagName === 'input' ||\n                tagName === 'textarea' ||\n                tagName === 'select') {\n                var value = n.value;\n                if (attributes_1.type !== 'radio' &&\n                    attributes_1.type !== 'checkbox' &&\n                    attributes_1.type !== 'submit' &&\n                    attributes_1.type !== 'button' &&\n                    value) {\n                    attributes_1.value =\n                        maskInputOptions[attributes_1.type] ||\n                            maskInputOptions[tagName]\n                            ? '*'.repeat(value.length)\n                            : value;\n                }\n                else if (n.checked) {\n                    attributes_1.checked = n.checked;\n                }\n            }\n            if (tagName === 'option') {\n                var selectValue = n.parentElement;\n                if (attributes_1.value === selectValue.value) {\n                    attributes_1.selected = n.selected;\n                }\n            }\n            if (tagName === 'canvas' && recordCanvas) {\n                attributes_1.rr_dataURL = n.toDataURL();\n            }\n            if (tagName === 'audio' || tagName === 'video') {\n                attributes_1.rr_mediaState = n.paused\n                    ? 'paused'\n                    : 'played';\n            }\n            if (n.scrollLeft) {\n                attributes_1.rr_scrollLeft = n.scrollLeft;\n            }\n            if (n.scrollTop) {\n                attributes_1.rr_scrollTop = n.scrollTop;\n            }\n            if (needBlock) {\n                var _d = n.getBoundingClientRect(), width = _d.width, height = _d.height;\n                attributes_1 = {\n                    class: attributes_1.class,\n                    rr_width: width + \"px\",\n                    rr_height: height + \"px\",\n                };\n            }\n            return {\n                type: NodeType.Element,\n                tagName: tagName,\n                attributes: attributes_1,\n                childNodes: [],\n                isSVG: isSVGElement(n) || undefined,\n                needBlock: needBlock,\n            };\n        case n.TEXT_NODE:\n            var parentTagName = n.parentNode && n.parentNode.tagName;\n            var textContent = n.textContent;\n            var isStyle = parentTagName === 'STYLE' ? true : undefined;\n            if (isStyle && textContent) {\n                textContent = absoluteToStylesheet(textContent, location.href);\n            }\n            if (parentTagName === 'SCRIPT') {\n                textContent = 'SCRIPT_PLACEHOLDER';\n            }\n            return {\n                type: NodeType.Text,\n                textContent: textContent || '',\n                isStyle: isStyle,\n            };\n        case n.CDATA_SECTION_NODE:\n            return {\n                type: NodeType.CDATA,\n                textContent: '',\n            };\n        case n.COMMENT_NODE:\n            return {\n                type: NodeType.Comment,\n                textContent: n.textContent || '',\n            };\n        default:\n            return false;\n    }\n}\nfunction lowerIfExists(maybeAttr) {\n    if (maybeAttr === undefined) {\n        return '';\n    }\n    else {\n        return maybeAttr.toLowerCase();\n    }\n}\nfunction slimDOMExcluded(sn, slimDOMOptions) {\n    if (slimDOMOptions.comment && sn.type === NodeType.Comment) {\n        return true;\n    }\n    else if (sn.type === NodeType.Element) {\n        if (slimDOMOptions.script &&\n            (sn.tagName === 'script' ||\n                (sn.tagName === 'link' &&\n                    sn.attributes.rel === 'preload' &&\n                    sn.attributes.as === 'script'))) {\n            return true;\n        }\n        else if (slimDOMOptions.headFavicon &&\n            ((sn.tagName === 'link' && sn.attributes.rel === 'shortcut icon') ||\n                (sn.tagName === 'meta' &&\n                    (lowerIfExists(sn.attributes.name).match(/^msapplication-tile(image|color)$/) ||\n                        lowerIfExists(sn.attributes.name) === 'application-name' ||\n                        lowerIfExists(sn.attributes.rel) === 'icon' ||\n                        lowerIfExists(sn.attributes.rel) === 'apple-touch-icon' ||\n                        lowerIfExists(sn.attributes.rel) === 'shortcut icon')))) {\n            return true;\n        }\n        else if (sn.tagName === 'meta') {\n            if (slimDOMOptions.headMetaDescKeywords &&\n                lowerIfExists(sn.attributes.name).match(/^description|keywords$/)) {\n                return true;\n            }\n            else if (slimDOMOptions.headMetaSocial &&\n                (lowerIfExists(sn.attributes.property).match(/^(og|twitter|fb):/) ||\n                    lowerIfExists(sn.attributes.name).match(/^(og|twitter):/) ||\n                    lowerIfExists(sn.attributes.name) === 'pinterest')) {\n                return true;\n            }\n            else if (slimDOMOptions.headMetaRobots &&\n                (lowerIfExists(sn.attributes.name) === 'robots' ||\n                    lowerIfExists(sn.attributes.name) === 'googlebot' ||\n                    lowerIfExists(sn.attributes.name) === 'bingbot')) {\n                return true;\n            }\n            else if (slimDOMOptions.headMetaHttpEquiv &&\n                sn.attributes['http-equiv'] !== undefined) {\n                return true;\n            }\n            else if (slimDOMOptions.headMetaAuthorship &&\n                (lowerIfExists(sn.attributes.name) === 'author' ||\n                    lowerIfExists(sn.attributes.name) === 'generator' ||\n                    lowerIfExists(sn.attributes.name) === 'framework' ||\n                    lowerIfExists(sn.attributes.name) === 'publisher' ||\n                    lowerIfExists(sn.attributes.name) === 'progid' ||\n                    lowerIfExists(sn.attributes.property).match(/^article:/) ||\n                    lowerIfExists(sn.attributes.property).match(/^product:/))) {\n                return true;\n            }\n            else if (slimDOMOptions.headMetaVerification &&\n                (lowerIfExists(sn.attributes.name) === 'google-site-verification' ||\n                    lowerIfExists(sn.attributes.name) === 'yandex-verification' ||\n                    lowerIfExists(sn.attributes.name) === 'csrf-token' ||\n                    lowerIfExists(sn.attributes.name) === 'p:domain_verify' ||\n                    lowerIfExists(sn.attributes.name) === 'verify-v1' ||\n                    lowerIfExists(sn.attributes.name) === 'verification' ||\n                    lowerIfExists(sn.attributes.name) === 'shopify-checkout-api-token')) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction serializeNodeWithId(n, options) {\n    var doc = options.doc, map = options.map, blockClass = options.blockClass, blockSelector = options.blockSelector, _a = options.skipChild, skipChild = _a === void 0 ? false : _a, _b = options.inlineStylesheet, inlineStylesheet = _b === void 0 ? true : _b, _c = options.maskInputOptions, maskInputOptions = _c === void 0 ? {} : _c, slimDOMOptions = options.slimDOMOptions, _d = options.recordCanvas, recordCanvas = _d === void 0 ? false : _d;\n    var _e = options.preserveWhiteSpace, preserveWhiteSpace = _e === void 0 ? true : _e;\n    var _serializedNode = serializeNode(n, {\n        doc: doc,\n        blockClass: blockClass,\n        blockSelector: blockSelector,\n        inlineStylesheet: inlineStylesheet,\n        maskInputOptions: maskInputOptions,\n        recordCanvas: recordCanvas,\n    });\n    if (!_serializedNode) {\n        console.warn(n, 'not serialized');\n        return null;\n    }\n    var id;\n    if ('__sn' in n) {\n        id = n.__sn.id;\n    }\n    else if (slimDOMExcluded(_serializedNode, slimDOMOptions) ||\n        (!preserveWhiteSpace &&\n            _serializedNode.type === NodeType.Text &&\n            !_serializedNode.isStyle &&\n            !_serializedNode.textContent.replace(/^\\s+|\\s+$/gm, '').length)) {\n        id = IGNORED_NODE;\n    }\n    else {\n        id = genId();\n    }\n    var serializedNode = Object.assign(_serializedNode, { id: id });\n    n.__sn = serializedNode;\n    if (id === IGNORED_NODE) {\n        return null;\n    }\n    map[id] = n;\n    var recordChild = !skipChild;\n    if (serializedNode.type === NodeType.Element) {\n        recordChild = recordChild && !serializedNode.needBlock;\n        delete serializedNode.needBlock;\n    }\n    if ((serializedNode.type === NodeType.Document ||\n        serializedNode.type === NodeType.Element) &&\n        recordChild) {\n        if (slimDOMOptions.headWhitespace &&\n            _serializedNode.type === NodeType.Element &&\n            _serializedNode.tagName === 'head') {\n            preserveWhiteSpace = false;\n        }\n        for (var _i = 0, _f = Array.from(n.childNodes); _i < _f.length; _i++) {\n            var childN = _f[_i];\n            var serializedChildNode = serializeNodeWithId(childN, {\n                doc: doc,\n                map: map,\n                blockClass: blockClass,\n                blockSelector: blockSelector,\n                skipChild: skipChild,\n                inlineStylesheet: inlineStylesheet,\n                maskInputOptions: maskInputOptions,\n                slimDOMOptions: slimDOMOptions,\n                recordCanvas: recordCanvas,\n                preserveWhiteSpace: preserveWhiteSpace,\n            });\n            if (serializedChildNode) {\n                serializedNode.childNodes.push(serializedChildNode);\n            }\n        }\n    }\n    return serializedNode;\n}\nfunction snapshot(n, options) {\n    var _a = options || {}, _b = _a.blockClass, blockClass = _b === void 0 ? 'rr-block' : _b, _c = _a.inlineStylesheet, inlineStylesheet = _c === void 0 ? true : _c, _d = _a.recordCanvas, recordCanvas = _d === void 0 ? false : _d, _e = _a.blockSelector, blockSelector = _e === void 0 ? null : _e, _f = _a.maskAllInputs, maskAllInputs = _f === void 0 ? false : _f, _g = _a.slimDOM, slimDOM = _g === void 0 ? false : _g;\n    var idNodeMap = {};\n    var maskInputOptions = maskAllInputs === true\n        ? {\n            color: true,\n            date: true,\n            'datetime-local': true,\n            email: true,\n            month: true,\n            number: true,\n            range: true,\n            search: true,\n            tel: true,\n            text: true,\n            time: true,\n            url: true,\n            week: true,\n            textarea: true,\n            select: true,\n        }\n        : maskAllInputs === false\n            ? {}\n            : maskAllInputs;\n    var slimDOMOptions = slimDOM === true || slimDOM === 'all'\n        ?\n            {\n                script: true,\n                comment: true,\n                headFavicon: true,\n                headWhitespace: true,\n                headMetaDescKeywords: slimDOM === 'all',\n                headMetaSocial: true,\n                headMetaRobots: true,\n                headMetaHttpEquiv: true,\n                headMetaAuthorship: true,\n                headMetaVerification: true,\n            }\n        : slimDOM === false\n            ? {}\n            : slimDOM;\n    return [\n        serializeNodeWithId(n, {\n            doc: n,\n            map: idNodeMap,\n            blockClass: blockClass,\n            blockSelector: blockSelector,\n            skipChild: false,\n            inlineStylesheet: inlineStylesheet,\n            maskInputOptions: maskInputOptions,\n            slimDOMOptions: slimDOMOptions,\n            recordCanvas: recordCanvas,\n        }),\n        idNodeMap,\n    ];\n}\n\nvar EventType;\n(function (EventType) {\n    EventType[EventType[\"DomContentLoaded\"] = 0] = \"DomContentLoaded\";\n    EventType[EventType[\"Load\"] = 1] = \"Load\";\n    EventType[EventType[\"FullSnapshot\"] = 2] = \"FullSnapshot\";\n    EventType[EventType[\"IncrementalSnapshot\"] = 3] = \"IncrementalSnapshot\";\n    EventType[EventType[\"Meta\"] = 4] = \"Meta\";\n    EventType[EventType[\"Custom\"] = 5] = \"Custom\";\n})(EventType || (EventType = {}));\nvar IncrementalSource;\n(function (IncrementalSource) {\n    IncrementalSource[IncrementalSource[\"Mutation\"] = 0] = \"Mutation\";\n    IncrementalSource[IncrementalSource[\"MouseMove\"] = 1] = \"MouseMove\";\n    IncrementalSource[IncrementalSource[\"MouseInteraction\"] = 2] = \"MouseInteraction\";\n    IncrementalSource[IncrementalSource[\"Scroll\"] = 3] = \"Scroll\";\n    IncrementalSource[IncrementalSource[\"ViewportResize\"] = 4] = \"ViewportResize\";\n    IncrementalSource[IncrementalSource[\"Input\"] = 5] = \"Input\";\n    IncrementalSource[IncrementalSource[\"TouchMove\"] = 6] = \"TouchMove\";\n    IncrementalSource[IncrementalSource[\"MediaInteraction\"] = 7] = \"MediaInteraction\";\n    IncrementalSource[IncrementalSource[\"StyleSheetRule\"] = 8] = \"StyleSheetRule\";\n    IncrementalSource[IncrementalSource[\"CanvasMutation\"] = 9] = \"CanvasMutation\";\n    IncrementalSource[IncrementalSource[\"Font\"] = 10] = \"Font\";\n    IncrementalSource[IncrementalSource[\"Log\"] = 11] = \"Log\";\n})(IncrementalSource || (IncrementalSource = {}));\nvar MouseInteractions;\n(function (MouseInteractions) {\n    MouseInteractions[MouseInteractions[\"MouseUp\"] = 0] = \"MouseUp\";\n    MouseInteractions[MouseInteractions[\"MouseDown\"] = 1] = \"MouseDown\";\n    MouseInteractions[MouseInteractions[\"Click\"] = 2] = \"Click\";\n    MouseInteractions[MouseInteractions[\"ContextMenu\"] = 3] = \"ContextMenu\";\n    MouseInteractions[MouseInteractions[\"DblClick\"] = 4] = \"DblClick\";\n    MouseInteractions[MouseInteractions[\"Focus\"] = 5] = \"Focus\";\n    MouseInteractions[MouseInteractions[\"Blur\"] = 6] = \"Blur\";\n    MouseInteractions[MouseInteractions[\"TouchStart\"] = 7] = \"TouchStart\";\n    MouseInteractions[MouseInteractions[\"TouchMove_Departed\"] = 8] = \"TouchMove_Departed\";\n    MouseInteractions[MouseInteractions[\"TouchEnd\"] = 9] = \"TouchEnd\";\n})(MouseInteractions || (MouseInteractions = {}));\nvar MediaInteractions;\n(function (MediaInteractions) {\n    MediaInteractions[MediaInteractions[\"Play\"] = 0] = \"Play\";\n    MediaInteractions[MediaInteractions[\"Pause\"] = 1] = \"Pause\";\n})(MediaInteractions || (MediaInteractions = {}));\nvar ReplayerEvents;\n(function (ReplayerEvents) {\n    ReplayerEvents[\"Start\"] = \"start\";\n    ReplayerEvents[\"Pause\"] = \"pause\";\n    ReplayerEvents[\"Resume\"] = \"resume\";\n    ReplayerEvents[\"Resize\"] = \"resize\";\n    ReplayerEvents[\"Finish\"] = \"finish\";\n    ReplayerEvents[\"FullsnapshotRebuilded\"] = \"fullsnapshot-rebuilded\";\n    ReplayerEvents[\"LoadStylesheetStart\"] = \"load-stylesheet-start\";\n    ReplayerEvents[\"LoadStylesheetEnd\"] = \"load-stylesheet-end\";\n    ReplayerEvents[\"SkipStart\"] = \"skip-start\";\n    ReplayerEvents[\"SkipEnd\"] = \"skip-end\";\n    ReplayerEvents[\"MouseInteraction\"] = \"mouse-interaction\";\n    ReplayerEvents[\"EventCast\"] = \"event-cast\";\n    ReplayerEvents[\"CustomEvent\"] = \"custom-event\";\n    ReplayerEvents[\"Flush\"] = \"flush\";\n    ReplayerEvents[\"StateChange\"] = \"state-change\";\n})(ReplayerEvents || (ReplayerEvents = {}));\n\nfunction on(type, fn, target) {\n    if (target === void 0) { target = document; }\n    var options = { capture: true, passive: true };\n    target.addEventListener(type, fn, options);\n    return function () { return target.removeEventListener(type, fn, options); };\n}\nvar mirror = {\n    map: {},\n    getId: function (n) {\n        if (!n.__sn) {\n            return -1;\n        }\n        return n.__sn.id;\n    },\n    getNode: function (id) {\n        return mirror.map[id] || null;\n    },\n    removeNodeFromMap: function (n) {\n        var id = n.__sn && n.__sn.id;\n        delete mirror.map[id];\n        if (n.childNodes) {\n            n.childNodes.forEach(function (child) {\n                return mirror.removeNodeFromMap(child);\n            });\n        }\n    },\n    has: function (id) {\n        return mirror.map.hasOwnProperty(id);\n    },\n};\nfunction throttle(func, wait, options) {\n    if (options === void 0) { options = {}; }\n    var timeout = null;\n    var previous = 0;\n    return function (arg) {\n        var now = Date.now();\n        if (!previous && options.leading === false) {\n            previous = now;\n        }\n        var remaining = wait - (now - previous);\n        var context = this;\n        var args = arguments;\n        if (remaining <= 0 || remaining > wait) {\n            if (timeout) {\n                window.clearTimeout(timeout);\n                timeout = null;\n            }\n            previous = now;\n            func.apply(context, args);\n        }\n        else if (!timeout && options.trailing !== false) {\n            timeout = window.setTimeout(function () {\n                previous = options.leading === false ? 0 : Date.now();\n                timeout = null;\n                func.apply(context, args);\n            }, remaining);\n        }\n    };\n}\nfunction hookSetter(target, key, d, isRevoked, win) {\n    if (win === void 0) { win = window; }\n    var original = win.Object.getOwnPropertyDescriptor(target, key);\n    win.Object.defineProperty(target, key, isRevoked\n        ? d\n        : {\n            set: function (value) {\n                var _this = this;\n                setTimeout(function () {\n                    d.set.call(_this, value);\n                }, 0);\n                if (original && original.set) {\n                    original.set.call(this, value);\n                }\n            },\n        });\n    return function () { return hookSetter(target, key, original || {}, true); };\n}\nfunction patch(source, name, replacement) {\n    try {\n        if (!(name in source)) {\n            return function () { };\n        }\n        var original_1 = source[name];\n        var wrapped = replacement(original_1);\n        if (typeof wrapped === 'function') {\n            wrapped.prototype = wrapped.prototype || {};\n            Object.defineProperties(wrapped, {\n                __rrweb_original__: {\n                    enumerable: false,\n                    value: original_1,\n                },\n            });\n        }\n        source[name] = wrapped;\n        return function () {\n            source[name] = original_1;\n        };\n    }\n    catch (_a) {\n        return function () { };\n    }\n}\nfunction getWindowHeight() {\n    return (window.innerHeight ||\n        (document.documentElement && document.documentElement.clientHeight) ||\n        (document.body && document.body.clientHeight));\n}\nfunction getWindowWidth() {\n    return (window.innerWidth ||\n        (document.documentElement && document.documentElement.clientWidth) ||\n        (document.body && document.body.clientWidth));\n}\nfunction isBlocked(node, blockClass) {\n    if (!node) {\n        return false;\n    }\n    if (node.nodeType === node.ELEMENT_NODE) {\n        var needBlock_1 = false;\n        if (typeof blockClass === 'string') {\n            needBlock_1 = node.classList.contains(blockClass);\n        }\n        else {\n            node.classList.forEach(function (className) {\n                if (blockClass.test(className)) {\n                    needBlock_1 = true;\n                }\n            });\n        }\n        return needBlock_1 || isBlocked(node.parentNode, blockClass);\n    }\n    if (node.nodeType === node.TEXT_NODE) {\n        return isBlocked(node.parentNode, blockClass);\n    }\n    return isBlocked(node.parentNode, blockClass);\n}\nfunction isIgnored(n) {\n    if ('__sn' in n) {\n        return n.__sn.id === IGNORED_NODE;\n    }\n    return false;\n}\nfunction isAncestorRemoved(target) {\n    var id = mirror.getId(target);\n    if (!mirror.has(id)) {\n        return true;\n    }\n    if (target.parentNode &&\n        target.parentNode.nodeType === target.DOCUMENT_NODE) {\n        return false;\n    }\n    if (!target.parentNode) {\n        return true;\n    }\n    return isAncestorRemoved(target.parentNode);\n}\nfunction isTouchEvent(event) {\n    return Boolean(event.changedTouches);\n}\nfunction polyfill(win) {\n    if (win === void 0) { win = window; }\n    if ('NodeList' in win && !win.NodeList.prototype.forEach) {\n        win.NodeList.prototype.forEach = Array.prototype\n            .forEach;\n    }\n    if ('DOMTokenList' in win && !win.DOMTokenList.prototype.forEach) {\n        win.DOMTokenList.prototype.forEach = Array.prototype\n            .forEach;\n    }\n}\n\nfunction isNodeInLinkedList(n) {\n    return '__ln' in n;\n}\nvar DoubleLinkedList = (function () {\n    function DoubleLinkedList() {\n        this.length = 0;\n        this.head = null;\n    }\n    DoubleLinkedList.prototype.get = function (position) {\n        if (position >= this.length) {\n            throw new Error('Position outside of list range');\n        }\n        var current = this.head;\n        for (var index = 0; index < position; index++) {\n            current = (current === null || current === void 0 ? void 0 : current.next) || null;\n        }\n        return current;\n    };\n    DoubleLinkedList.prototype.addNode = function (n) {\n        var node = {\n            value: n,\n            previous: null,\n            next: null,\n        };\n        n.__ln = node;\n        if (n.previousSibling && isNodeInLinkedList(n.previousSibling)) {\n            var current = n.previousSibling.__ln.next;\n            node.next = current;\n            node.previous = n.previousSibling.__ln;\n            n.previousSibling.__ln.next = node;\n            if (current) {\n                current.previous = node;\n            }\n        }\n        else if (n.nextSibling && isNodeInLinkedList(n.nextSibling)) {\n            var current = n.nextSibling.__ln.previous;\n            node.previous = current;\n            node.next = n.nextSibling.__ln;\n            n.nextSibling.__ln.previous = node;\n            if (current) {\n                current.next = node;\n            }\n        }\n        else {\n            if (this.head) {\n                this.head.previous = node;\n            }\n            node.next = this.head;\n            this.head = node;\n        }\n        this.length++;\n    };\n    DoubleLinkedList.prototype.removeNode = function (n) {\n        var current = n.__ln;\n        if (!this.head) {\n            return;\n        }\n        if (!current.previous) {\n            this.head = current.next;\n            if (this.head) {\n                this.head.previous = null;\n            }\n        }\n        else {\n            current.previous.next = current.next;\n            if (current.next) {\n                current.next.previous = current.previous;\n            }\n        }\n        if (n.__ln) {\n            delete n.__ln;\n        }\n        this.length--;\n    };\n    return DoubleLinkedList;\n}());\nvar moveKey = function (id, parentId) { return id + \"@\" + parentId; };\nfunction isINode(n) {\n    return '__sn' in n;\n}\nvar MutationBuffer = (function () {\n    function MutationBuffer() {\n        var _this = this;\n        this.frozen = false;\n        this.texts = [];\n        this.attributes = [];\n        this.removes = [];\n        this.mapRemoves = [];\n        this.movedMap = {};\n        this.addedSet = new Set();\n        this.movedSet = new Set();\n        this.droppedSet = new Set();\n        this.processMutations = function (mutations) {\n            mutations.forEach(_this.processMutation);\n            if (!_this.frozen) {\n                _this.emit();\n            }\n        };\n        this.emit = function () {\n            var e_1, _a, e_2, _b;\n            var adds = [];\n            var addList = new DoubleLinkedList();\n            var getNextId = function (n) {\n                var ns = n;\n                var nextId = IGNORED_NODE;\n                while (nextId === IGNORED_NODE) {\n                    ns = ns && ns.nextSibling;\n                    nextId = ns && mirror.getId(ns);\n                }\n                if (nextId === -1 && isBlocked(n.nextSibling, _this.blockClass)) {\n                    nextId = null;\n                }\n                return nextId;\n            };\n            var pushAdd = function (n) {\n                if (!n.parentNode || !document.contains(n)) {\n                    return;\n                }\n                var parentId = mirror.getId(n.parentNode);\n                var nextId = getNextId(n);\n                if (parentId === -1 || nextId === -1) {\n                    return addList.addNode(n);\n                }\n                var sn = serializeNodeWithId(n, {\n                    doc: document,\n                    map: mirror.map,\n                    blockClass: _this.blockClass,\n                    blockSelector: _this.blockSelector,\n                    skipChild: true,\n                    inlineStylesheet: _this.inlineStylesheet,\n                    maskInputOptions: _this.maskInputOptions,\n                    slimDOMOptions: _this.slimDOMOptions,\n                    recordCanvas: _this.recordCanvas,\n                });\n                if (sn) {\n                    adds.push({\n                        parentId: parentId,\n                        nextId: nextId,\n                        node: sn,\n                    });\n                }\n            };\n            while (_this.mapRemoves.length) {\n                mirror.removeNodeFromMap(_this.mapRemoves.shift());\n            }\n            try {\n                for (var _c = __values(_this.movedSet), _d = _c.next(); !_d.done; _d = _c.next()) {\n                    var n = _d.value;\n                    if (isParentRemoved(_this.removes, n) &&\n                        !_this.movedSet.has(n.parentNode)) {\n                        continue;\n                    }\n                    pushAdd(n);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            try {\n                for (var _e = __values(_this.addedSet), _f = _e.next(); !_f.done; _f = _e.next()) {\n                    var n = _f.value;\n                    if (!isAncestorInSet(_this.droppedSet, n) &&\n                        !isParentRemoved(_this.removes, n)) {\n                        pushAdd(n);\n                    }\n                    else if (isAncestorInSet(_this.movedSet, n)) {\n                        pushAdd(n);\n                    }\n                    else {\n                        _this.droppedSet.add(n);\n                    }\n                }\n            }\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\n            finally {\n                try {\n                    if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                }\n                finally { if (e_2) throw e_2.error; }\n            }\n            var candidate = null;\n            while (addList.length) {\n                var node = null;\n                if (candidate) {\n                    var parentId = mirror.getId(candidate.value.parentNode);\n                    var nextId = getNextId(candidate.value);\n                    if (parentId !== -1 && nextId !== -1) {\n                        node = candidate;\n                    }\n                }\n                if (!node) {\n                    for (var index = addList.length - 1; index >= 0; index--) {\n                        var _node = addList.get(index);\n                        var parentId = mirror.getId(_node.value.parentNode);\n                        var nextId = getNextId(_node.value);\n                        if (parentId !== -1 && nextId !== -1) {\n                            node = _node;\n                            break;\n                        }\n                    }\n                }\n                if (!node) {\n                    while (addList.head) {\n                        addList.removeNode(addList.head.value);\n                    }\n                    break;\n                }\n                candidate = node.previous;\n                addList.removeNode(node.value);\n                pushAdd(node.value);\n            }\n            var payload = {\n                texts: _this.texts\n                    .map(function (text) { return ({\n                    id: mirror.getId(text.node),\n                    value: text.value,\n                }); })\n                    .filter(function (text) { return mirror.has(text.id); }),\n                attributes: _this.attributes\n                    .map(function (attribute) { return ({\n                    id: mirror.getId(attribute.node),\n                    attributes: attribute.attributes,\n                }); })\n                    .filter(function (attribute) { return mirror.has(attribute.id); }),\n                removes: _this.removes,\n                adds: adds,\n            };\n            if (!payload.texts.length &&\n                !payload.attributes.length &&\n                !payload.removes.length &&\n                !payload.adds.length) {\n                return;\n            }\n            _this.texts = [];\n            _this.attributes = [];\n            _this.removes = [];\n            _this.addedSet = new Set();\n            _this.movedSet = new Set();\n            _this.droppedSet = new Set();\n            _this.movedMap = {};\n            _this.emissionCallback(payload);\n        };\n        this.processMutation = function (m) {\n            if (isIgnored(m.target)) {\n                return;\n            }\n            switch (m.type) {\n                case 'characterData': {\n                    var value = m.target.textContent;\n                    if (!isBlocked(m.target, _this.blockClass) && value !== m.oldValue) {\n                        _this.texts.push({\n                            value: value,\n                            node: m.target,\n                        });\n                    }\n                    break;\n                }\n                case 'attributes': {\n                    var value = m.target.getAttribute(m.attributeName);\n                    if (isBlocked(m.target, _this.blockClass) || value === m.oldValue) {\n                        return;\n                    }\n                    var item = _this.attributes.find(function (a) { return a.node === m.target; });\n                    if (!item) {\n                        item = {\n                            node: m.target,\n                            attributes: {},\n                        };\n                        _this.attributes.push(item);\n                    }\n                    item.attributes[m.attributeName] = transformAttribute(document, m.attributeName, value);\n                    break;\n                }\n                case 'childList': {\n                    m.addedNodes.forEach(function (n) { return _this.genAdds(n, m.target); });\n                    m.removedNodes.forEach(function (n) {\n                        var nodeId = mirror.getId(n);\n                        var parentId = mirror.getId(m.target);\n                        if (isBlocked(n, _this.blockClass) ||\n                            isBlocked(m.target, _this.blockClass) ||\n                            isIgnored(n)) {\n                            return;\n                        }\n                        if (_this.addedSet.has(n)) {\n                            deepDelete(_this.addedSet, n);\n                            _this.droppedSet.add(n);\n                        }\n                        else if (_this.addedSet.has(m.target) && nodeId === -1) ;\n                        else if (isAncestorRemoved(m.target)) ;\n                        else if (_this.movedSet.has(n) &&\n                            _this.movedMap[moveKey(nodeId, parentId)]) {\n                            deepDelete(_this.movedSet, n);\n                        }\n                        else {\n                            _this.removes.push({\n                                parentId: parentId,\n                                id: nodeId,\n                            });\n                        }\n                        _this.mapRemoves.push(n);\n                    });\n                    break;\n                }\n            }\n        };\n        this.genAdds = function (n, target) {\n            if (isBlocked(n, _this.blockClass)) {\n                return;\n            }\n            if (target && isBlocked(target, _this.blockClass)) {\n                return;\n            }\n            if (isINode(n)) {\n                if (isIgnored(n)) {\n                    return;\n                }\n                _this.movedSet.add(n);\n                var targetId = null;\n                if (target && isINode(target)) {\n                    targetId = target.__sn.id;\n                }\n                if (targetId) {\n                    _this.movedMap[moveKey(n.__sn.id, targetId)] = true;\n                }\n            }\n            else {\n                _this.addedSet.add(n);\n                _this.droppedSet.delete(n);\n            }\n            n.childNodes.forEach(function (childN) { return _this.genAdds(childN); });\n        };\n    }\n    MutationBuffer.prototype.init = function (cb, blockClass, blockSelector, inlineStylesheet, maskInputOptions, recordCanvas, slimDOMOptions) {\n        this.blockClass = blockClass;\n        this.blockSelector = blockSelector;\n        this.inlineStylesheet = inlineStylesheet;\n        this.maskInputOptions = maskInputOptions;\n        this.recordCanvas = recordCanvas;\n        this.slimDOMOptions = slimDOMOptions;\n        this.emissionCallback = cb;\n    };\n    MutationBuffer.prototype.freeze = function () {\n        this.frozen = true;\n    };\n    MutationBuffer.prototype.unfreeze = function () {\n        this.frozen = false;\n    };\n    MutationBuffer.prototype.isFrozen = function () {\n        return this.frozen;\n    };\n    return MutationBuffer;\n}());\nfunction deepDelete(addsSet, n) {\n    addsSet.delete(n);\n    n.childNodes.forEach(function (childN) { return deepDelete(addsSet, childN); });\n}\nfunction isParentRemoved(removes, n) {\n    var parentNode = n.parentNode;\n    if (!parentNode) {\n        return false;\n    }\n    var parentId = mirror.getId(parentNode);\n    if (removes.some(function (r) { return r.id === parentId; })) {\n        return true;\n    }\n    return isParentRemoved(removes, parentNode);\n}\nfunction isAncestorInSet(set, n) {\n    var parentNode = n.parentNode;\n    if (!parentNode) {\n        return false;\n    }\n    if (set.has(parentNode)) {\n        return true;\n    }\n    return isAncestorInSet(set, parentNode);\n}\n\nfunction pathToSelector(node) {\n    if (!node || !node.outerHTML) {\n        return '';\n    }\n    var path = '';\n    while (node.parentElement) {\n        var name = node.localName;\n        if (!name)\n            break;\n        name = name.toLowerCase();\n        var parent = node.parentElement;\n        var domSiblings = [];\n        if (parent.children && parent.children.length > 0) {\n            for (var i = 0; i < parent.children.length; i++) {\n                var sibling = parent.children[i];\n                if (sibling.localName && sibling.localName.toLowerCase) {\n                    if (sibling.localName.toLowerCase() === name) {\n                        domSiblings.push(sibling);\n                    }\n                }\n            }\n        }\n        if (domSiblings.length > 1) {\n            name += ':eq(' + domSiblings.indexOf(node) + ')';\n        }\n        path = name + (path ? '>' + path : '');\n        node = parent;\n    }\n    return path;\n}\nfunction stringify(obj, stringifyOptions) {\n    var options = {\n        numOfKeysLimit: 50,\n    };\n    Object.assign(options, stringifyOptions);\n    var stack = [], keys = [];\n    return JSON.stringify(obj, function (key, value) {\n        if (stack.length > 0) {\n            var thisPos = stack.indexOf(this);\n            ~thisPos ? stack.splice(thisPos + 1) : stack.push(this);\n            ~thisPos ? keys.splice(thisPos, Infinity, key) : keys.push(key);\n            if (~stack.indexOf(value)) {\n                if (stack[0] === value)\n                    value = '[Circular ~]';\n                else\n                    value =\n                        '[Circular ~.' +\n                            keys.slice(0, stack.indexOf(value)).join('.') +\n                            ']';\n            }\n        }\n        else\n            stack.push(value);\n        if (value === null || value === undefined)\n            return value;\n        if (shouldToString(value)) {\n            return toString(value);\n        }\n        if (value instanceof Event) {\n            var eventResult = {};\n            for (var key_1 in value) {\n                var eventValue = value[key_1];\n                if (Array.isArray(eventValue))\n                    eventResult[key_1] = pathToSelector(eventValue.length ? eventValue[0] : null);\n                else\n                    eventResult[key_1] = eventValue;\n            }\n            return eventResult;\n        }\n        else if (value instanceof Node) {\n            if (value instanceof HTMLElement)\n                return value ? value.outerHTML : '';\n            return value.nodeName;\n        }\n        return value;\n    });\n    function shouldToString(obj) {\n        if (typeof obj === 'object' &&\n            Object.keys(obj).length > options.numOfKeysLimit)\n            return true;\n        if (typeof obj === 'function')\n            return true;\n        return false;\n    }\n    function toString(obj) {\n        var str = obj.toString();\n        if (options.stringLengthLimit && str.length > options.stringLengthLimit) {\n            str = str.slice(0, options.stringLengthLimit) + \"...\";\n        }\n        return str;\n    }\n}\n\nvar mutationBuffer = new MutationBuffer();\nfunction initMutationObserver(cb, blockClass, blockSelector, inlineStylesheet, maskInputOptions, recordCanvas, slimDOMOptions) {\n    mutationBuffer.init(cb, blockClass, blockSelector, inlineStylesheet, maskInputOptions, recordCanvas, slimDOMOptions);\n    var observer = new MutationObserver(mutationBuffer.processMutations.bind(mutationBuffer));\n    observer.observe(document, {\n        attributes: true,\n        attributeOldValue: true,\n        characterData: true,\n        characterDataOldValue: true,\n        childList: true,\n        subtree: true,\n    });\n    return observer;\n}\nfunction initMoveObserver(cb, sampling) {\n    if (sampling.mousemove === false) {\n        return function () { };\n    }\n    var threshold = typeof sampling.mousemove === 'number' ? sampling.mousemove : 50;\n    var positions = [];\n    var timeBaseline;\n    var wrappedCb = throttle(function (isTouch) {\n        var totalOffset = Date.now() - timeBaseline;\n        cb(positions.map(function (p) {\n            p.timeOffset -= totalOffset;\n            return p;\n        }), isTouch ? IncrementalSource.TouchMove : IncrementalSource.MouseMove);\n        positions = [];\n        timeBaseline = null;\n    }, 500);\n    var updatePosition = throttle(function (evt) {\n        var target = evt.target;\n        var _a = isTouchEvent(evt)\n            ? evt.changedTouches[0]\n            : evt, clientX = _a.clientX, clientY = _a.clientY;\n        if (!timeBaseline) {\n            timeBaseline = Date.now();\n        }\n        positions.push({\n            x: clientX,\n            y: clientY,\n            id: mirror.getId(target),\n            timeOffset: Date.now() - timeBaseline,\n        });\n        wrappedCb(isTouchEvent(evt));\n    }, threshold, {\n        trailing: false,\n    });\n    var handlers = [\n        on('mousemove', updatePosition),\n        on('touchmove', updatePosition),\n    ];\n    return function () {\n        handlers.forEach(function (h) { return h(); });\n    };\n}\nfunction initMouseInteractionObserver(cb, blockClass, sampling) {\n    if (sampling.mouseInteraction === false) {\n        return function () { };\n    }\n    var disableMap = sampling.mouseInteraction === true ||\n        sampling.mouseInteraction === undefined\n        ? {}\n        : sampling.mouseInteraction;\n    var handlers = [];\n    var getHandler = function (eventKey) {\n        return function (event) {\n            if (isBlocked(event.target, blockClass)) {\n                return;\n            }\n            var id = mirror.getId(event.target);\n            var _a = isTouchEvent(event)\n                ? event.changedTouches[0]\n                : event, clientX = _a.clientX, clientY = _a.clientY;\n            cb({\n                type: MouseInteractions[eventKey],\n                id: id,\n                x: clientX,\n                y: clientY,\n            });\n        };\n    };\n    Object.keys(MouseInteractions)\n        .filter(function (key) {\n        return Number.isNaN(Number(key)) &&\n            !key.endsWith('_Departed') &&\n            disableMap[key] !== false;\n    })\n        .forEach(function (eventKey) {\n        var eventName = eventKey.toLowerCase();\n        var handler = getHandler(eventKey);\n        handlers.push(on(eventName, handler));\n    });\n    return function () {\n        handlers.forEach(function (h) { return h(); });\n    };\n}\nfunction initScrollObserver(cb, blockClass, sampling) {\n    var updatePosition = throttle(function (evt) {\n        if (!evt.target || isBlocked(evt.target, blockClass)) {\n            return;\n        }\n        var id = mirror.getId(evt.target);\n        if (evt.target === document) {\n            var scrollEl = (document.scrollingElement || document.documentElement);\n            cb({\n                id: id,\n                x: scrollEl.scrollLeft,\n                y: scrollEl.scrollTop,\n            });\n        }\n        else {\n            cb({\n                id: id,\n                x: evt.target.scrollLeft,\n                y: evt.target.scrollTop,\n            });\n        }\n    }, sampling.scroll || 100);\n    return on('scroll', updatePosition);\n}\nfunction initViewportResizeObserver(cb) {\n    var last_h = -1;\n    var last_w = -1;\n    var updateDimension = throttle(function () {\n        var height = getWindowHeight();\n        var width = getWindowWidth();\n        if (last_h !== height || last_w != width) {\n            cb({\n                width: Number(width),\n                height: Number(height),\n            });\n            last_h = height;\n            last_w = width;\n        }\n    }, 200);\n    return on('resize', updateDimension, window);\n}\nvar INPUT_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\nvar lastInputValueMap = new WeakMap();\nfunction initInputObserver(cb, blockClass, ignoreClass, maskInputOptions, maskInputFn, sampling) {\n    function eventHandler(event) {\n        var target = event.target;\n        if (!target ||\n            !target.tagName ||\n            INPUT_TAGS.indexOf(target.tagName) < 0 ||\n            isBlocked(target, blockClass)) {\n            return;\n        }\n        var type = target.type;\n        if (type === 'password' ||\n            target.classList.contains(ignoreClass)) {\n            return;\n        }\n        var text = target.value;\n        var isChecked = false;\n        if (type === 'radio' || type === 'checkbox') {\n            isChecked = target.checked;\n        }\n        else if (maskInputOptions[target.tagName.toLowerCase()] ||\n            maskInputOptions[type]) {\n            if (maskInputFn) {\n                text = maskInputFn(text);\n            }\n            else {\n                text = '*'.repeat(text.length);\n            }\n        }\n        cbWithDedup(target, { text: text, isChecked: isChecked });\n        var name = target.name;\n        if (type === 'radio' && name && isChecked) {\n            document\n                .querySelectorAll(\"input[type=\\\"radio\\\"][name=\\\"\" + name + \"\\\"]\")\n                .forEach(function (el) {\n                if (el !== target) {\n                    cbWithDedup(el, {\n                        text: el.value,\n                        isChecked: !isChecked,\n                    });\n                }\n            });\n        }\n    }\n    function cbWithDedup(target, v) {\n        var lastInputValue = lastInputValueMap.get(target);\n        if (!lastInputValue ||\n            lastInputValue.text !== v.text ||\n            lastInputValue.isChecked !== v.isChecked) {\n            lastInputValueMap.set(target, v);\n            var id = mirror.getId(target);\n            cb(__assign(__assign({}, v), { id: id }));\n        }\n    }\n    var events = sampling.input === 'last' ? ['change'] : ['input', 'change'];\n    var handlers = events.map(function (eventName) { return on(eventName, eventHandler); });\n    var propertyDescriptor = Object.getOwnPropertyDescriptor(HTMLInputElement.prototype, 'value');\n    var hookProperties = [\n        [HTMLInputElement.prototype, 'value'],\n        [HTMLInputElement.prototype, 'checked'],\n        [HTMLSelectElement.prototype, 'value'],\n        [HTMLTextAreaElement.prototype, 'value'],\n        [HTMLSelectElement.prototype, 'selectedIndex'],\n    ];\n    if (propertyDescriptor && propertyDescriptor.set) {\n        handlers.push.apply(handlers, __spread(hookProperties.map(function (p) {\n            return hookSetter(p[0], p[1], {\n                set: function () {\n                    eventHandler({ target: this });\n                },\n            });\n        })));\n    }\n    return function () {\n        handlers.forEach(function (h) { return h(); });\n    };\n}\nfunction initStyleSheetObserver(cb) {\n    var insertRule = CSSStyleSheet.prototype.insertRule;\n    CSSStyleSheet.prototype.insertRule = function (rule, index) {\n        var id = mirror.getId(this.ownerNode);\n        if (id !== -1) {\n            cb({\n                id: id,\n                adds: [{ rule: rule, index: index }],\n            });\n        }\n        return insertRule.apply(this, arguments);\n    };\n    var deleteRule = CSSStyleSheet.prototype.deleteRule;\n    CSSStyleSheet.prototype.deleteRule = function (index) {\n        var id = mirror.getId(this.ownerNode);\n        if (id !== -1) {\n            cb({\n                id: id,\n                removes: [{ index: index }],\n            });\n        }\n        return deleteRule.apply(this, arguments);\n    };\n    return function () {\n        CSSStyleSheet.prototype.insertRule = insertRule;\n        CSSStyleSheet.prototype.deleteRule = deleteRule;\n    };\n}\nfunction initMediaInteractionObserver(mediaInteractionCb, blockClass) {\n    var handler = function (type) { return function (event) {\n        var target = event.target;\n        if (!target || isBlocked(target, blockClass)) {\n            return;\n        }\n        mediaInteractionCb({\n            type: type === 'play' ? MediaInteractions.Play : MediaInteractions.Pause,\n            id: mirror.getId(target),\n        });\n    }; };\n    var handlers = [on('play', handler('play')), on('pause', handler('pause'))];\n    return function () {\n        handlers.forEach(function (h) { return h(); });\n    };\n}\nfunction initCanvasMutationObserver(cb, blockClass) {\n    var e_1, _a;\n    var props = Object.getOwnPropertyNames(CanvasRenderingContext2D.prototype);\n    var handlers = [];\n    var _loop_1 = function (prop) {\n        try {\n            if (typeof CanvasRenderingContext2D.prototype[prop] !== 'function') {\n                return \"continue\";\n            }\n            var restoreHandler = patch(CanvasRenderingContext2D.prototype, prop, function (original) {\n                return function () {\n                    var _this = this;\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    if (!isBlocked(this.canvas, blockClass)) {\n                        setTimeout(function () {\n                            var recordArgs = __spread(args);\n                            if (prop === 'drawImage') {\n                                if (recordArgs[0] &&\n                                    recordArgs[0] instanceof HTMLCanvasElement) {\n                                    recordArgs[0] = recordArgs[0].toDataURL();\n                                }\n                            }\n                            cb({\n                                id: mirror.getId(_this.canvas),\n                                property: prop,\n                                args: recordArgs,\n                            });\n                        }, 0);\n                    }\n                    return original.apply(this, args);\n                };\n            });\n            handlers.push(restoreHandler);\n        }\n        catch (_a) {\n            var hookHandler = hookSetter(CanvasRenderingContext2D.prototype, prop, {\n                set: function (v) {\n                    cb({\n                        id: mirror.getId(this.canvas),\n                        property: prop,\n                        args: [v],\n                        setter: true,\n                    });\n                },\n            });\n            handlers.push(hookHandler);\n        }\n    };\n    try {\n        for (var props_1 = __values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n            var prop = props_1_1.value;\n            _loop_1(prop);\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return function () {\n        handlers.forEach(function (h) { return h(); });\n    };\n}\nfunction initFontObserver(cb) {\n    var handlers = [];\n    var fontMap = new WeakMap();\n    var originalFontFace = FontFace;\n    window.FontFace = function FontFace(family, source, descriptors) {\n        var fontFace = new originalFontFace(family, source, descriptors);\n        fontMap.set(fontFace, {\n            family: family,\n            buffer: typeof source !== 'string',\n            descriptors: descriptors,\n            fontSource: typeof source === 'string'\n                ? source\n                :\n                    JSON.stringify(Array.from(new Uint8Array(source))),\n        });\n        return fontFace;\n    };\n    var restoreHandler = patch(document.fonts, 'add', function (original) {\n        return function (fontFace) {\n            setTimeout(function () {\n                var p = fontMap.get(fontFace);\n                if (p) {\n                    cb(p);\n                    fontMap.delete(fontFace);\n                }\n            }, 0);\n            return original.apply(this, [fontFace]);\n        };\n    });\n    handlers.push(function () {\n        window.FonFace = originalFontFace;\n    });\n    handlers.push(restoreHandler);\n    return function () {\n        handlers.forEach(function (h) { return h(); });\n    };\n}\nfunction initLogObserver(cb, logOptions) {\n    var e_2, _a;\n    var _this = this;\n    var logger = logOptions.logger;\n    if (!logger)\n        return function () { };\n    var logCount = 0;\n    var cancelHandlers = [];\n    if (logOptions.level.includes('error')) {\n        if (window) {\n            var originalOnError_1 = window.onerror;\n            window.onerror = function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                originalOnError_1 && originalOnError_1.apply(_this, args);\n                var stack = [];\n                if (args[args.length - 1] instanceof Error)\n                    stack = parseStack(args[args.length - 1].stack, 0);\n                var payload = [stringify(args[0], logOptions.stringifyOptions)];\n                cb({\n                    level: 'error',\n                    trace: stack,\n                    payload: payload,\n                });\n            };\n            cancelHandlers.push(function () {\n                window.onerror = originalOnError_1;\n            });\n        }\n    }\n    try {\n        for (var _b = __values(logOptions.level), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var levelType = _c.value;\n            cancelHandlers.push(replace(logger, levelType));\n        }\n    }\n    catch (e_2_1) { e_2 = { error: e_2_1 }; }\n    finally {\n        try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        }\n        finally { if (e_2) throw e_2.error; }\n    }\n    return function () {\n        cancelHandlers.forEach(function (h) { return h(); });\n    };\n    function replace(logger, level) {\n        var _this = this;\n        if (!logger[level])\n            return function () { };\n        return patch(logger, level, function (original) {\n            return function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                original.apply(_this, args);\n                try {\n                    var stack = parseStack(new Error().stack);\n                    var payload = args.map(function (s) {\n                        return stringify(s, logOptions.stringifyOptions);\n                    });\n                    logCount++;\n                    if (logCount < logOptions.lengthThreshold)\n                        cb({\n                            level: level,\n                            trace: stack,\n                            payload: payload,\n                        });\n                    else if (logCount === logOptions.lengthThreshold)\n                        cb({\n                            level: 'warn',\n                            trace: [],\n                            payload: [\n                                stringify('The number of log records reached the threshold.'),\n                            ],\n                        });\n                }\n                catch (error) {\n                    original.apply(void 0, __spread(['rrweb logger error:', error], args));\n                }\n            };\n        });\n    }\n    function parseStack(stack, omitDepth) {\n        if (omitDepth === void 0) { omitDepth = 1; }\n        var stacks = [];\n        if (stack) {\n            stacks = stack\n                .split('at')\n                .splice(1 + omitDepth)\n                .map(function (s) { return s.trim(); });\n        }\n        return stacks;\n    }\n}\nfunction mergeHooks(o, hooks) {\n    var mutationCb = o.mutationCb, mousemoveCb = o.mousemoveCb, mouseInteractionCb = o.mouseInteractionCb, scrollCb = o.scrollCb, viewportResizeCb = o.viewportResizeCb, inputCb = o.inputCb, mediaInteractionCb = o.mediaInteractionCb, styleSheetRuleCb = o.styleSheetRuleCb, canvasMutationCb = o.canvasMutationCb, fontCb = o.fontCb, logCb = o.logCb;\n    o.mutationCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.mutation) {\n            hooks.mutation.apply(hooks, __spread(p));\n        }\n        mutationCb.apply(void 0, __spread(p));\n    };\n    o.mousemoveCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.mousemove) {\n            hooks.mousemove.apply(hooks, __spread(p));\n        }\n        mousemoveCb.apply(void 0, __spread(p));\n    };\n    o.mouseInteractionCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.mouseInteraction) {\n            hooks.mouseInteraction.apply(hooks, __spread(p));\n        }\n        mouseInteractionCb.apply(void 0, __spread(p));\n    };\n    o.scrollCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.scroll) {\n            hooks.scroll.apply(hooks, __spread(p));\n        }\n        scrollCb.apply(void 0, __spread(p));\n    };\n    o.viewportResizeCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.viewportResize) {\n            hooks.viewportResize.apply(hooks, __spread(p));\n        }\n        viewportResizeCb.apply(void 0, __spread(p));\n    };\n    o.inputCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.input) {\n            hooks.input.apply(hooks, __spread(p));\n        }\n        inputCb.apply(void 0, __spread(p));\n    };\n    o.mediaInteractionCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.mediaInteaction) {\n            hooks.mediaInteaction.apply(hooks, __spread(p));\n        }\n        mediaInteractionCb.apply(void 0, __spread(p));\n    };\n    o.styleSheetRuleCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.styleSheetRule) {\n            hooks.styleSheetRule.apply(hooks, __spread(p));\n        }\n        styleSheetRuleCb.apply(void 0, __spread(p));\n    };\n    o.canvasMutationCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.canvasMutation) {\n            hooks.canvasMutation.apply(hooks, __spread(p));\n        }\n        canvasMutationCb.apply(void 0, __spread(p));\n    };\n    o.fontCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.font) {\n            hooks.font.apply(hooks, __spread(p));\n        }\n        fontCb.apply(void 0, __spread(p));\n    };\n    o.logCb = function () {\n        var p = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            p[_i] = arguments[_i];\n        }\n        if (hooks.log) {\n            hooks.log.apply(hooks, __spread(p));\n        }\n        logCb.apply(void 0, __spread(p));\n    };\n}\nfunction initObservers(o, hooks) {\n    if (hooks === void 0) { hooks = {}; }\n    mergeHooks(o, hooks);\n    var mutationObserver = initMutationObserver(o.mutationCb, o.blockClass, o.blockSelector, o.inlineStylesheet, o.maskInputOptions, o.recordCanvas, o.slimDOMOptions);\n    var mousemoveHandler = initMoveObserver(o.mousemoveCb, o.sampling);\n    var mouseInteractionHandler = initMouseInteractionObserver(o.mouseInteractionCb, o.blockClass, o.sampling);\n    var scrollHandler = initScrollObserver(o.scrollCb, o.blockClass, o.sampling);\n    var viewportResizeHandler = initViewportResizeObserver(o.viewportResizeCb);\n    var inputHandler = initInputObserver(o.inputCb, o.blockClass, o.ignoreClass, o.maskInputOptions, o.maskInputFn, o.sampling);\n    var mediaInteractionHandler = initMediaInteractionObserver(o.mediaInteractionCb, o.blockClass);\n    var styleSheetObserver = initStyleSheetObserver(o.styleSheetRuleCb);\n    var canvasMutationObserver = o.recordCanvas\n        ? initCanvasMutationObserver(o.canvasMutationCb, o.blockClass)\n        : function () { };\n    var fontObserver = o.collectFonts ? initFontObserver(o.fontCb) : function () { };\n    var logObserver = o.logOptions\n        ? initLogObserver(o.logCb, o.logOptions)\n        : function () { };\n    return function () {\n        mutationObserver.disconnect();\n        mousemoveHandler();\n        mouseInteractionHandler();\n        scrollHandler();\n        viewportResizeHandler();\n        inputHandler();\n        mediaInteractionHandler();\n        styleSheetObserver();\n        canvasMutationObserver();\n        fontObserver();\n        logObserver();\n    };\n}\n\nfunction wrapEvent(e) {\n    return __assign(__assign({}, e), { timestamp: Date.now() });\n}\nvar wrappedEmit;\nfunction record(options) {\n    if (options === void 0) { options = {}; }\n    var emit = options.emit, checkoutEveryNms = options.checkoutEveryNms, checkoutEveryNth = options.checkoutEveryNth, _a = options.blockClass, blockClass = _a === void 0 ? 'rr-block' : _a, _b = options.blockSelector, blockSelector = _b === void 0 ? null : _b, _c = options.ignoreClass, ignoreClass = _c === void 0 ? 'rr-ignore' : _c, _d = options.inlineStylesheet, inlineStylesheet = _d === void 0 ? true : _d, maskAllInputs = options.maskAllInputs, _maskInputOptions = options.maskInputOptions, _slimDOMOptions = options.slimDOMOptions, maskInputFn = options.maskInputFn, hooks = options.hooks, packFn = options.packFn, _e = options.sampling, sampling = _e === void 0 ? {} : _e, mousemoveWait = options.mousemoveWait, _f = options.recordCanvas, recordCanvas = _f === void 0 ? false : _f, _g = options.collectFonts, collectFonts = _g === void 0 ? false : _g, _h = options.recordLog, recordLog = _h === void 0 ? false : _h;\n    if (!emit) {\n        throw new Error('emit function is required');\n    }\n    if (mousemoveWait !== undefined && sampling.mousemove === undefined) {\n        sampling.mousemove = mousemoveWait;\n    }\n    var maskInputOptions = maskAllInputs === true\n        ? {\n            color: true,\n            date: true,\n            'datetime-local': true,\n            email: true,\n            month: true,\n            number: true,\n            range: true,\n            search: true,\n            tel: true,\n            text: true,\n            time: true,\n            url: true,\n            week: true,\n            textarea: true,\n            select: true,\n        }\n        : _maskInputOptions !== undefined\n            ? _maskInputOptions\n            : {};\n    var slimDOMOptions = _slimDOMOptions === true || _slimDOMOptions === 'all'\n        ? {\n            script: true,\n            comment: true,\n            headFavicon: true,\n            headWhitespace: true,\n            headMetaSocial: true,\n            headMetaRobots: true,\n            headMetaHttpEquiv: true,\n            headMetaVerification: true,\n            headMetaAuthorship: _slimDOMOptions === 'all',\n            headMetaDescKeywords: _slimDOMOptions === 'all',\n        }\n        : _slimDOMOptions\n            ? _slimDOMOptions\n            : {};\n    var defaultLogOptions = {\n        level: [\n            'assert',\n            'clear',\n            'count',\n            'countReset',\n            'debug',\n            'dir',\n            'dirxml',\n            'error',\n            'group',\n            'groupCollapsed',\n            'groupEnd',\n            'info',\n            'log',\n            'table',\n            'time',\n            'timeEnd',\n            'timeLog',\n            'trace',\n            'warn',\n        ],\n        lengthThreshold: 1000,\n        logger: console,\n    };\n    var logOptions = recordLog\n        ? recordLog === true\n            ? defaultLogOptions\n            : Object.assign({}, defaultLogOptions, recordLog)\n        : {};\n    polyfill();\n    var lastFullSnapshotEvent;\n    var incrementalSnapshotCount = 0;\n    wrappedEmit = function (e, isCheckout) {\n        if (mutationBuffer.isFrozen() &&\n            e.type !== EventType.FullSnapshot &&\n            !(e.type === EventType.IncrementalSnapshot &&\n                e.data.source === IncrementalSource.Mutation)) {\n            mutationBuffer.emit();\n            mutationBuffer.unfreeze();\n        }\n        emit((packFn ? packFn(e) : e), isCheckout);\n        if (e.type === EventType.FullSnapshot) {\n            lastFullSnapshotEvent = e;\n            incrementalSnapshotCount = 0;\n        }\n        else if (e.type === EventType.IncrementalSnapshot) {\n            incrementalSnapshotCount++;\n            var exceedCount = checkoutEveryNth && incrementalSnapshotCount >= checkoutEveryNth;\n            var exceedTime = checkoutEveryNms &&\n                e.timestamp - lastFullSnapshotEvent.timestamp > checkoutEveryNms;\n            if (exceedCount || exceedTime) {\n                takeFullSnapshot(true);\n            }\n        }\n    };\n    function takeFullSnapshot(isCheckout) {\n        var _a, _b, _c, _d;\n        if (isCheckout === void 0) { isCheckout = false; }\n        wrappedEmit(wrapEvent({\n            type: EventType.Meta,\n            data: {\n                href: window.location.href,\n                width: getWindowWidth(),\n                height: getWindowHeight(),\n            },\n        }), isCheckout);\n        var wasFrozen = mutationBuffer.isFrozen();\n        mutationBuffer.freeze();\n        var _e = __read(snapshot(document, {\n            blockClass: blockClass,\n            blockSelector: blockSelector,\n            inlineStylesheet: inlineStylesheet,\n            maskAllInputs: maskInputOptions,\n            slimDOM: slimDOMOptions,\n            recordCanvas: recordCanvas,\n        }), 2), node = _e[0], idNodeMap = _e[1];\n        if (!node) {\n            return console.warn('Failed to snapshot the document');\n        }\n        mirror.map = idNodeMap;\n        wrappedEmit(wrapEvent({\n            type: EventType.FullSnapshot,\n            data: {\n                node: node,\n                initialOffset: {\n                    left: window.pageXOffset !== undefined\n                        ? window.pageXOffset\n                        : (document === null || document === void 0 ? void 0 : document.documentElement.scrollLeft) || ((_b = (_a = document === null || document === void 0 ? void 0 : document.body) === null || _a === void 0 ? void 0 : _a.parentElement) === null || _b === void 0 ? void 0 : _b.scrollLeft) || (document === null || document === void 0 ? void 0 : document.body.scrollLeft) ||\n                            0,\n                    top: window.pageYOffset !== undefined\n                        ? window.pageYOffset\n                        : (document === null || document === void 0 ? void 0 : document.documentElement.scrollTop) || ((_d = (_c = document === null || document === void 0 ? void 0 : document.body) === null || _c === void 0 ? void 0 : _c.parentElement) === null || _d === void 0 ? void 0 : _d.scrollTop) || (document === null || document === void 0 ? void 0 : document.body.scrollTop) ||\n                            0,\n                },\n            },\n        }));\n        if (!wasFrozen) {\n            mutationBuffer.emit();\n            mutationBuffer.unfreeze();\n        }\n    }\n    try {\n        var handlers_1 = [];\n        handlers_1.push(on('DOMContentLoaded', function () {\n            wrappedEmit(wrapEvent({\n                type: EventType.DomContentLoaded,\n                data: {},\n            }));\n        }));\n        var init_1 = function () {\n            takeFullSnapshot();\n            handlers_1.push(initObservers({\n                mutationCb: function (m) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.Mutation }, m),\n                    }));\n                },\n                mousemoveCb: function (positions, source) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: {\n                            source: source,\n                            positions: positions,\n                        },\n                    }));\n                },\n                mouseInteractionCb: function (d) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.MouseInteraction }, d),\n                    }));\n                },\n                scrollCb: function (p) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.Scroll }, p),\n                    }));\n                },\n                viewportResizeCb: function (d) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.ViewportResize }, d),\n                    }));\n                },\n                inputCb: function (v) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.Input }, v),\n                    }));\n                },\n                mediaInteractionCb: function (p) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.MediaInteraction }, p),\n                    }));\n                },\n                styleSheetRuleCb: function (r) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.StyleSheetRule }, r),\n                    }));\n                },\n                canvasMutationCb: function (p) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.CanvasMutation }, p),\n                    }));\n                },\n                fontCb: function (p) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.Font }, p),\n                    }));\n                },\n                logCb: function (p) {\n                    return wrappedEmit(wrapEvent({\n                        type: EventType.IncrementalSnapshot,\n                        data: __assign({ source: IncrementalSource.Log }, p),\n                    }));\n                },\n                blockClass: blockClass,\n                blockSelector: blockSelector,\n                ignoreClass: ignoreClass,\n                maskInputOptions: maskInputOptions,\n                maskInputFn: maskInputFn,\n                inlineStylesheet: inlineStylesheet,\n                sampling: sampling,\n                recordCanvas: recordCanvas,\n                collectFonts: collectFonts,\n                slimDOMOptions: slimDOMOptions,\n                logOptions: logOptions,\n            }, hooks));\n        };\n        if (document.readyState === 'interactive' ||\n            document.readyState === 'complete') {\n            init_1();\n        }\n        else {\n            handlers_1.push(on('load', function () {\n                wrappedEmit(wrapEvent({\n                    type: EventType.Load,\n                    data: {},\n                }));\n                init_1();\n            }, window));\n        }\n        return function () {\n            handlers_1.forEach(function (h) { return h(); });\n        };\n    }\n    catch (error) {\n        console.warn(error);\n    }\n}\nrecord.addCustomEvent = function (tag, payload) {\n    if (!wrappedEmit) {\n        throw new Error('please add custom event after start recording');\n    }\n    wrappedEmit(wrapEvent({\n        type: EventType.Custom,\n        data: {\n            tag: tag,\n            payload: payload,\n        },\n    }));\n};\nrecord.freezePage = function () {\n    mutationBuffer.freeze();\n};\n\nmodule.exports = record;\n","import record from 'rrweb/lib/record/rrweb-record'\nimport { AskPriority, ErrorType } from '../typings'\nimport { config } from '../config'\nimport { W } from '../data'\n\nexport default class ErrorTrace {\n    // 上报的错误信息\n    private errorInfo\n    // rrweb录播的信息\n    private recordEvents\n\n    constructor() {\n        this.recordEvents = [];\n    }\n\n    // rrweb录播形象方法\n    private recordAction() {\n        const _this = this;\n        record({\n            emit(event, isCheckout) {\n                // isCheckout 是一个标识，告诉你重新制作了快照\n                if (isCheckout) _this.recordEvents = []\n\n                _this.recordEvents.push(event)\n            },\n            checkoutEveryNth: 1000, // 每 100个event 重新制作快照\n            checkoutEveryNms: 5 * 60 * 1000, // 每5分钟重新制作快照\n        })\n    }\n\n    // 监控全局同步和异步的异常\n    private grobalError() {\n        W.onerror = (event: Event, source?: string, lineno?: number, colno?: number, error?: Error): boolean => {\n            console.log('[ ❌全局捕获错误 ]', error)\n            //通过错误信息还原sourcemap源文件地址\n            const errorInfo = JSON.stringify({\n                source,\n                lineno,\n                colno,\n                error,\n                type: ErrorType[1],\n                record: this.recordEvents.slice(-100),\n            })\n            config.report.sendToAnalytics(AskPriority.IDLE, errorInfo)\n            return true\n        }\n    }\n\n    // 监控promise异常\n    private promiseError() {\n        const _this = this;\n        W.addEventListener('unhandledrejection', function (e) {\n            console.log('[ ❌promise捕获错误 ]', e)\n            e.preventDefault()\n            // 上报primise异常\n            const errorInfo = JSON.stringify({\n                e,\n                type: ErrorType[2],\n                record: _this.recordEvents.slice(-100),\n            })\n            config.report.sendToAnalytics(AskPriority.IDLE, errorInfo)\n            return true\n        })\n    }\n\n    // 监控资源请求异常\n    private networkError() {\n        const _this = this;\n        W.addEventListener(\n            'error',\n            function (e: ErrorEvent) {\n                if (e.target !== W) {\n                    console.log('[ ❌资源请求捕获错误 ]', e.target)\n                    const errorInfo = JSON.stringify({\n                        e,\n                        type: ErrorType[2],\n                        record: _this.recordEvents.slice(-100),\n                    })\n                    config.report.sendToAnalytics(AskPriority.IDLE, errorInfo)\n                }\n            },\n            true\n        )\n    }\n\n    // 重写console.error\n    private consoleErrorReflect() {\n        const consoleError = W.console.error\n\n        W.console.error = function () {\n            console.log('[ ❌console.error捕获错误 ]')\n            //config.report.sendToAnalytics(AskPriority.IDLE, errorInfo);\n            consoleError.apply(W, [...arguments])\n        }\n    }\n\n    // 初始化异常监听\n    public run() {\n        this.grobalError()\n        this.promiseError()\n        this.networkError()\n        this.consoleErrorReflect()\n        this.recordAction()\n    }\n}\n","/**\n * 一款开源的性能、异常监控sdk\n * @remarks\n * 目前支持监控的性能指标：FCP、LCP、FID、TBT、CLS\n * @packageDocumentation\n */\n\nimport { YMonitorOptions, YMonitorConfig, YMonitorReport } from './typings'\nimport { isPerformanceSupported } from './helps'\nimport { Report, analyticsTracker } from './data'\nimport { initPerformanceTraceEntry } from './performance'\nimport { config } from './config'\nimport ErrorTrace from './error'\n\nexport class YMonitor {\n    private version: string = '0.0.1'\n    private report: YMonitorReport\n\n    constructor(options: YMonitorOptions) {\n        if (!options.upUrl) {\n            throw Error(`监控sdk-${this.version}需提供上报uri!`)\n        }\n\n        Object.assign(config, options)\n        config.report = new Report({ upUrl: options.upUrl })\n        config.analyticsTracker = config.analyticsTracker || analyticsTracker\n        // 对外暴露上报接口\n        this.report = config.report\n\n        // 初始化\n        this.initErrorMonitor(config)\n        this.initPerformanceMonitor(config)\n    }\n\n    // 初始化异常监控\n    initErrorMonitor(args: YMonitorConfig) {\n        if (!args.isErrorCapture) return\n\n        new ErrorTrace().run()\n    }\n\n    // 初始化性能监控\n    initPerformanceMonitor(args: YMonitorConfig) {\n        //如果浏览器不支持性能指标或者未开启则放弃\n        if (!isPerformanceSupported() || !args.isPerformanceTrace) return\n\n        //浏览器支持的起FRP这样的Observer统计性能\n        initPerformanceTraceEntry()\n    }\n}\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}